<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Joureli - Journal, Calendar & Planning</title>
	<style>
		* {
			margin: 0;
			padding: 0;
			box-sizing: border-box;
		}

		body {
			font-family: 'Segoe UI', Arial, sans-serif;
			background: linear-gradient(135deg, #f8fafc 0%, #e0e7ef 100%);
			color: #2b3a67;
			min-height: 100vh;
			padding: 20px;
		}

		.container {
			max-width: 1400px;
			margin: 0 auto;
		}

		/* Header */
		.header {
			text-align: center;
			margin-bottom: 30px;
			animation: slideDown 0.6s ease-out;
		}

		.header h1 {
			font-size: 2.5rem;
			color: #2b3a67;
			margin-bottom: 10px;
		}

		.header p {
			color: #4f5d75;
			font-size: 1.1rem;
			margin-bottom: 15px;
		}

		/* View Toggle */
		.view-toggle {
			display: flex;
			gap: 10px;
			justify-content: center;
			margin-bottom: 25px;
		}

		.toggle-btn {
			padding: 10px 25px;
			border: 2px solid #e0e7ef;
			background: #fff;
			color: #2b3a67;
			border-radius: 8px;
			cursor: pointer;
			font-weight: 600;
			transition: all 0.3s ease;
			font-size: 0.95rem;
		}

		.toggle-btn:hover {
			border-color: #4056a1;
		}

		.toggle-btn.active {
			background: #2b3a67;
			color: #fff;
			border-color: #2b3a67;
		}

		/* Main Layout */
		.layout {
			display: grid;
			grid-template-columns: 1fr 350px;
			gap: 20px;
			margin-bottom: 30px;
		}

		/* Calendar Wrapper */
		.calendar-wrapper {
			background: #fff;
			border-radius: 16px;
			padding: 30px;
			box-shadow: 0 4px 24px rgba(0,0,0,0.08);
			display: none;
		}

		.calendar-wrapper.active {
			display: block;
		}

		/* Timeline Wrapper */
		.timeline-wrapper {
			background: #fff;
			border-radius: 16px;
			padding: 30px;
			box-shadow: 0 4px 24px rgba(0,0,0,0.08);
			display: none;
		}

		.timeline-wrapper.active {
			display: block;
		}

		/* Calendar Header */
		.calendar-header {
			display: flex;
			justify-content: space-between;
			align-items: center;
			margin-bottom: 30px;
			gap: 20px;
		}

		.calendar-header h2 {
			font-size: 1.8rem;
			color: #2b3a67;
			min-width: 200px;
			text-align: center;
		}

		.calendar-nav {
			display: flex;
			gap: 10px;
		}

		.nav-btn {
			background: #2b3a67;
			color: #fff;
			border: none;
			padding: 10px 20px;
			border-radius: 8px;
			cursor: pointer;
			transition: all 0.3s ease;
			font-size: 0.9rem;
		}

		.nav-btn:hover {
			background: #4056a1;
			transform: translateY(-2px);
			box-shadow: 0 5px 15px rgba(43, 58, 103, 0.3);
		}

		.today-btn {
			background: #4056a1;
		}

		/* Timeline */
		.timeline {
			position: relative;
			padding: 0;
		}

		.timeline::before {
			content: '';
			position: absolute;
			left: 40px;
			top: 0;
			bottom: 0;
			width: 3px;
			background: linear-gradient(180deg, #4056a1 0%, #8b5cf6 50%, #10b981 100%);
			border-radius: 10px;
		}

		.timeline-day-group {
			margin-bottom: 40px;
		}

		.timeline-day-header {
			font-weight: 700;
			font-size: 1rem;
			color: #2b3a67;
			margin-bottom: 20px;
			padding-left: 100px;
			text-transform: uppercase;
			letter-spacing: 0.5px;
			opacity: 0.8;
		}

		.timeline-event {
			margin-bottom: 25px;
			padding-left: 100px;
			position: relative;
			animation: fadeInUp 0.5s ease-out forwards;
		}

		@keyframes fadeInUp {
			from {
				opacity: 0;
				transform: translateY(20px);
			}
			to {
				opacity: 1;
				transform: translateY(0);
			}
		}

		.timeline-event:nth-child(1) { animation-delay: 0.05s; }
		.timeline-event:nth-child(2) { animation-delay: 0.1s; }
		.timeline-event:nth-child(3) { animation-delay: 0.15s; }
		.timeline-event:nth-child(4) { animation-delay: 0.2s; }
		.timeline-event:nth-child(5) { animation-delay: 0.25s; }

		.timeline-dot {
			position: absolute;
			left: 25px;
			top: 12px;
			width: 30px;
			height: 30px;
			background: #fff;
			border: 4px solid;
			border-radius: 50%;
			display: flex;
			align-items: center;
			justify-content: center;
			font-weight: bold;
			font-size: 0.7rem;
			transition: all 0.3s ease;
			z-index: 2;
		}

		.timeline-event:hover .timeline-dot {
			transform: scale(1.2);
			box-shadow: 0 0 15px rgba(0,0,0,0.2);
		}

		.timeline-event-card {
			background: #fff;
			padding: 20px;
			border-radius: 12px;
			cursor: pointer;
			transition: all 0.3s ease;
			box-shadow: 0 2px 12px rgba(0,0,0,0.08);
			border: 2px solid transparent;
			position: relative;
			overflow: hidden;
		}

		.timeline-event-card::before {
			content: '';
			position: absolute;
			top: 0;
			left: 0;
			width: 4px;
			height: 100%;
		}

		.timeline-event-card:hover {
			transform: translateX(8px) translateY(-2px);
			box-shadow: 0 10px 30px rgba(0,0,0,0.15);
			border-color: #e0e7ef;
		}

		.timeline-event-time {
			font-size: 0.85rem;
			font-weight: 700;
			color: #4056a1;
			margin-bottom: 8px;
			text-transform: uppercase;
			letter-spacing: 0.5px;
		}

		.timeline-event-title {
			font-weight: 700;
			color: #2b3a67;
			margin-bottom: 8px;
			font-size: 1.1rem;
		}

		.timeline-event-category {
			display: inline-block;
			font-size: 0.75rem;
			font-weight: 600;
			padding: 4px 10px;
			border-radius: 20px;
			text-transform: uppercase;
			letter-spacing: 0.5px;
			margin-bottom: 10px;
		}

		.timeline-event-desc {
			font-size: 0.9rem;
			color: #4f5d75;
			margin-bottom: 12px;
			line-height: 1.5;
		}

		.timeline-event-actions {
			display: flex;
			gap: 10px;
			padding-top: 12px;
			border-top: 1px solid #e0e7ef;
		}

		.timeline-event-btn {
			background: none;
			border: 1px solid #cbd5e1;
			color: #2b3a67;
			cursor: pointer;
			font-size: 0.85rem;
			padding: 6px 14px;
			border-radius: 6px;
			transition: all 0.2s ease;
			font-weight: 500;
		}

		.timeline-event-btn:hover {
			background: #2b3a67;
			color: #fff;
			border-color: #2b3a67;
			transform: translateY(-2px);
		}

		/* Weekdays */
		.weekdays {
			display: grid;
			grid-template-columns: repeat(7, 1fr);
			gap: 10px;
			margin-bottom: 10px;
		}

		.weekday {
			text-align: center;
			font-weight: 600;
			color: #4056a1;
			padding: 10px;
			font-size: 0.9rem;
		}

		/* Calendar Grid */
		.calendar-grid {
			display: grid;
			grid-template-columns: repeat(7, 1fr);
			gap: 10px;
		}

		.day {
			aspect-ratio: 1;
			background: #f8fafc;
			border: 2px solid #e0e7ef;
			border-radius: 12px;
			padding: 10px;
			cursor: pointer;
			transition: all 0.3s ease;
			display: flex;
			flex-direction: column;
			position: relative;
			overflow: hidden;
			min-height: 120px;
		}

		.day:hover {
			background: #fff;
			border-color: #4056a1;
			box-shadow: 0 8px 20px rgba(43, 58, 103, 0.12);
			transform: translateY(-2px);
		}

		.day.other-month {
			background: #f1f5f9;
			color: #9ca3af;
		}

		.day.today {
			background: linear-gradient(135deg, #4056a1 0%, #2b3a67 100%);
			color: #fff;
			border-color: #2b3a67;
		}

		.day-number {
			font-weight: 600;
			font-size: 1rem;
			margin-bottom: 5px;
		}

		.day-events {
			flex: 1;
			overflow-y: auto;
			font-size: 0.75rem;
		}

		.event-badge {
			background: #e0e7ef;
			color: #2b3a67;
			padding: 2px 6px;
			border-radius: 4px;
			margin-bottom: 3px;
			white-space: nowrap;
			overflow: hidden;
			text-overflow: ellipsis;
			cursor: pointer;
			transition: all 0.2s ease;
		}

		.today .event-badge {
			background: rgba(255, 255, 255, 0.3);
			color: #fff;
		}

		.event-badge:hover {
			background: #4056a1;
			color: #fff;
		}

		.event-count {
			font-size: 0.7rem;
			color: #4f5d75;
			margin-top: 3px;
		}

		/* Multi-day event styles */
		.multi-day-event {
			position: absolute;
			top: 5px;
			left: 5px;
			right: 5px;
			padding: 6px 8px;
			border-radius: 6px;
			font-size: 0.75rem;
			font-weight: 600;
			color: #fff;
			cursor: pointer;
			white-space: nowrap;
			overflow: hidden;
			text-overflow: ellipsis;
			transition: all 0.2s ease;
			z-index: 3;
			background: linear-gradient(90deg, var(--event-color, #4056a1), rgba(64, 86, 161, 0.7));
			border: 1px solid rgba(255, 255, 255, 0.3);
		}

		.multi-day-event:hover {
			transform: scaleY(1.1);
			box-shadow: 0 4px 12px rgba(0,0,0,0.15);
		}

		.day.multi-day-event-start {
			border-top-right-radius: 0;
			border-bottom-right-radius: 0;
		}

		.day.multi-day-event-middle {
			border-radius: 0;
		}

		.day.multi-day-event-end {
			border-top-left-radius: 0;
			border-bottom-left-radius: 0;
		}

		/* Sidebar */
		.sidebar {
			display: flex;
			flex-direction: column;
			gap: 20px;
		}

		.sidebar-card {
			background: #fff;
			border-radius: 16px;
			padding: 20px;
			box-shadow: 0 4px 24px rgba(0,0,0,0.08);
		}

		.sidebar-card h3 {
			color: #2b3a67;
			margin-bottom: 15px;
			font-size: 1.1rem;
		}

		/* Sidebar Tabs */
		.sidebar-tabs {
			display: flex;
			gap: 10px;
			margin-bottom: 20px;
			border-bottom: 2px solid #e0e7ef;
			background: #fff;
			border-radius: 16px;
			padding: 15px 20px 0;
			box-shadow: 0 4px 24px rgba(0,0,0,0.08);
		}

		.sidebar-tab {
			padding: 10px 15px;
			border: none;
			background: none;
			color: #4f5d75;
			font-weight: 600;
			cursor: pointer;
			border-bottom: 3px solid transparent;
			margin-bottom: -15px;
			padding-bottom: 15px;
			transition: all 0.3s ease;
			font-size: 0.9rem;
		}

		.sidebar-tab:hover {
			color: #2b3a67;
		}

		.sidebar-tab.active {
			color: #2b3a67;
			border-bottom-color: #2b3a67;
		}

		.sidebar-content {
			display: none;
		}

		.sidebar-content.active {
			display: block;
		}

		/* Journal Entry - Day One Aesthetic */
		.journal-entry {
			background: #fff;
			border-radius: 12px;
			padding: 16px;
			margin-bottom: 16px;
			box-shadow: 0 2px 8px rgba(0,0,0,0.06);
			border: 1px solid #e8eef5;
			transition: all 0.3s ease;
			cursor: pointer;
		}

		.journal-entry:hover {
			transform: translateY(-2px);
			box-shadow: 0 8px 20px rgba(0,0,0,0.10);
			border-color: #4056a1;
		}

		.journal-entry-header {
			display: flex;
			align-items: center;
			justify-content: space-between;
			margin-bottom: 12px;
			gap: 12px;
		}

		.journal-entry-date {
			font-weight: 700;
			color: #2b3a67;
			font-size: 0.95rem;
			letter-spacing: 0.3px;
		}

		.journal-entry-mood {
			font-size: 1.5rem;
			min-width: 24px;
		}

		.journal-entry-text {
			color: #3a3a3a;
			font-size: 0.95rem;
			line-height: 1.6;
			margin-bottom: 12px;
			word-wrap: break-word;
		}

		.journal-entry-meta {
			display: flex;
			justify-content: space-between;
			align-items: center;
			margin-bottom: 12px;
			font-size: 0.8rem;
			color: #8b94a5;
			border-bottom: 1px solid #f0f3f7;
			padding-bottom: 12px;
		}

		.journal-entry-stats {
			display: flex;
			gap: 16px;
		}

		.journal-entry-stat {
			display: flex;
			align-items: center;
			gap: 4px;
		}

		.journal-entry-tags {
			display: flex;
			gap: 6px;
			flex-wrap: wrap;
			margin-bottom: 12px;
		}

		.journal-entry-tag {
			background: #f0f3f7;
			color: #4056a1;
			padding: 4px 10px;
			border-radius: 16px;
			font-size: 0.75rem;
			font-weight: 500;
		}

		.journal-entry-actions {
			display: flex;
			gap: 8px;
			justify-content: flex-end;
		}

		.journal-entry-btn {
			background: none;
			border: 1px solid #e0e7ef;
			color: #4056a1;
			cursor: pointer;
			font-size: 0.8rem;
			padding: 6px 12px;
			border-radius: 6px;
			transition: all 0.2s ease;
			font-weight: 500;
		}

		.journal-entry-btn:hover {
			background: #f0f3f7;
			border-color: #4056a1;
			color: #2b3a67;
		}

		.journal-day-header {
			font-weight: 700;
			color: #2b3a67;
			font-size: 1rem;
			margin: 20px 0 16px 0;
			padding-bottom: 12px;
			border-bottom: 2px solid #e8eef5;
			letter-spacing: 0.3px;
		}

		.journal-day-events {
			background: linear-gradient(135deg, #f8fafc 0%, #f0f3f7 100%);
			border-radius: 10px;
			padding: 14px;
			margin-bottom: 16px;
			font-size: 0.9rem;
			border: 1px solid #e8eef5;
		}

		.journal-day-event {
			display: flex;
			align-items: center;
			gap: 10px;
			margin-bottom: 10px;
			padding-bottom: 10px;
			border-bottom: 1px solid rgba(224, 231, 239, 0.5);
		}

		.journal-day-event:last-child {
			margin-bottom: 0;
			padding-bottom: 0;
			border-bottom: none;
		}

		.journal-day-event-badge {
			display: inline-block;
			width: 10px;
			height: 10px;
			border-radius: 50%;
			flex-shrink: 0;
		}

		.journal-day-event-text {
			color: #2b3a67;
			flex: 1;
			font-weight: 500;
		}

		.journal-no-entries {
			text-align: center;
			padding: 20px;
			color: #8b94a5;
			font-style: italic;
		}

		/* Mood Selector */
		.mood-selector {
			display: flex;
			gap: 8px;
			margin-bottom: 12px;
			flex-wrap: wrap;
		}

		.mood-btn {
			font-size: 1.8rem;
			background: none;
			border: 2px solid #e0e7ef;
			border-radius: 50%;
			width: 50px;
			height: 50px;
			cursor: pointer;
			transition: all 0.2s ease;
			display: flex;
			align-items: center;
			justify-content: center;
		}

		.mood-btn:hover {
			transform: scale(1.1);
		}

		.mood-btn.selected {
			border-color: #4056a1;
			background: #f0f3f7;
		}

		/* Tags Input */
		.tags-input-container {
			display: flex;
			gap: 6px;
			flex-wrap: wrap;
			margin-bottom: 12px;
			padding: 8px;
			background: #f8fafc;
			border-radius: 8px;
			min-height: 40px;
			align-items: center;
		}

		.tag-badge {
			background: #4056a1;
			color: #fff;
			padding: 4px 10px;
			border-radius: 16px;
			font-size: 0.8rem;
			display: flex;
			align-items: center;
			gap: 6px;
		}

		.tag-badge-remove {
			cursor: pointer;
			font-weight: bold;
			opacity: 0.8;
		}

		.tag-badge-remove:hover {
			opacity: 1;
		}

		.tags-input {
			flex: 1;
			min-width: 100px;
			border: none;
			background: transparent;
			outline: none;
			font-size: 0.9rem;
		}

		/* Event Form */
		.event-form {
			display: flex;
			flex-direction: column;
			gap: 12px;
		}

		.form-group {
			display: flex;
			flex-direction: column;
			gap: 5px;
		}

		.form-group label {
			font-weight: 500;
			color: #2b3a67;
			font-size: 0.9rem;
		}

		.form-group input,
		.form-group select,
		.form-group textarea {
			padding: 10px;
			border: 2px solid #e0e7ef;
			border-radius: 8px;
			font-family: inherit;
			color: #2b3a67;
			transition: all 0.2s ease;
		}

		.form-group input:focus,
		.form-group select:focus,
		.form-group textarea:focus {
			outline: none;
			border-color: #4056a1;
			box-shadow: 0 0 0 3px rgba(64, 86, 161, 0.1);
		}

		.form-group input::placeholder {
			color: #9ca3af;
		}

		.add-event-btn {
			background: #2b3a67;
			color: #fff;
			border: none;
			padding: 12px;
			border-radius: 8px;
			cursor: pointer;
			font-weight: 600;
			transition: all 0.3s ease;
			margin-top: 5px;
		}

		.add-event-btn:hover {
			background: #4056a1;
			transform: translateY(-2px);
			box-shadow: 0 5px 15px rgba(43, 58, 103, 0.3);
		}

		.add-event-btn:active {
			transform: translateY(0);
		}

		/* Upcoming Events */
		.upcoming-events {
			max-height: 400px;
			overflow-y: auto;
		}

		.event-item {
			background: #f8fafc;
			padding: 12px;
			border-radius: 8px;
			margin-bottom: 10px;
			border-left: 4px solid #4056a1;
			transition: all 0.2s ease;
		}

		.event-item:hover {
			background: #e0e7ef;
			transform: translateX(5px);
		}

		.event-item-title {
			font-weight: 600;
			color: #2b3a67;
			margin-bottom: 3px;
		}

		.event-item-date {
			font-size: 0.8rem;
			color: #4f5d75;
		}

		.event-item-actions {
			display: flex;
			gap: 8px;
			margin-top: 8px;
		}

		.event-item-btn {
			background: none;
			border: none;
			color: #4f5d75;
			cursor: pointer;
			font-size: 0.8rem;
			padding: 4px 8px;
			border-radius: 4px;
			transition: all 0.2s ease;
		}

		.event-item-btn:hover {
			background: #4056a1;
			color: #fff;
		}

		.empty-message {
			text-align: center;
			color: #9ca3af;
			padding: 20px 0;
		}

		/* Modal */
		.modal {
			display: none;
			position: fixed;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			background: rgba(0, 0, 0, 0.5);
			z-index: 1000;
			justify-content: center;
			align-items: center;
			animation: fadeIn 0.3s ease-out;
			overflow-y: auto;
		}

		.modal.active {
			display: flex;
		}

		@keyframes fadeIn {
			from { opacity: 0; }
			to { opacity: 1; }
		}

		.modal-content {
			background: #fff;
			border-radius: 16px;
			padding: 30px;
			max-width: 500px;
			width: 90%;
			box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
			animation: slideUp 0.3s ease-out;
			margin: auto;
		}

		@keyframes slideUp {
			from {
				transform: translateY(30px);
				opacity: 0;
			}
			to {
				transform: translateY(0);
				opacity: 1;
			}
		}

		.modal-header {
			display: flex;
			justify-content: space-between;
			align-items: center;
			margin-bottom: 20px;
			border-bottom: 2px solid #e0e7ef;
			padding-bottom: 15px;
		}

		.modal-header h2 {
			color: #2b3a67;
			font-size: 1.5rem;
		}

		.close-btn {
			background: none;
			border: none;
			font-size: 1.5rem;
			cursor: pointer;
			color: #9ca3af;
			transition: color 0.2s ease;
		}

		.close-btn:hover {
			color: #2b3a67;
		}

		.modal-body {
			margin-bottom: 20px;
			max-height: 60vh;
			overflow-y: auto;
		}

		.modal-footer {
			display: flex;
			gap: 10px;
			justify-content: flex-end;
		}

		.modal-btn {
			padding: 10px 20px;
			border: none;
			border-radius: 8px;
			cursor: pointer;
			font-weight: 500;
			transition: all 0.2s ease;
		}

		.modal-btn-primary {
			background: #2b3a67;
			color: #fff;
		}

		.modal-btn-primary:hover {
			background: #4056a1;
		}

		.modal-btn-danger {
			background: #ef4444;
			color: #fff;
		}

		.modal-btn-danger:hover {
			background: #dc2626;
		}

		.modal-btn-secondary {
			background: #e0e7ef;
			color: #2b3a67;
		}

		.modal-btn-secondary:hover {
			background: #cbd5e1;
		}

		/* Responsive */
		@media (max-width: 1024px) {
			.layout {
				grid-template-columns: 1fr;
			}

			.sidebar {
				display: grid;
				grid-template-columns: 1fr 1fr;
			}
		}

		@media (max-width: 768px) {
			.header h1 {
				font-size: 2rem;
			}

			.calendar-header {
				flex-direction: column;
				gap: 15px;
			}

			.sidebar {
				grid-template-columns: 1fr;
			}

			.day {
				min-height: 100px;
				padding: 8px;
			}

			.day-number {
				font-size: 0.9rem;
			}

			.event-badge {
				font-size: 0.65rem;
			}

			.timeline::before {
				left: 20px;
			}

			.timeline-dot {
				left: 7px;
				width: 26px;
				height: 26px;
			}

			.timeline-event {
				padding-left: 60px;
			}
		}

		@keyframes slideDown {
			from {
				opacity: 0;
				transform: translateY(-20px);
			}
			to {
				opacity: 1;
				transform: translateY(0);
			}
		}

		/* Journal Writing Modal - Focus Mode */
		.journal-write-modal {
			display: none;
			position: fixed;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			background: rgba(0, 0, 0, 0.7);
			z-index: 2000;
			animation: fadeIn 0.3s ease-out;
		}

		.journal-write-modal.active {
			display: flex;
			align-items: center;
			justify-content: center;
		}

		.journal-write-container {
			background: #fff;
			border-radius: 20px;
			width: 95vw;
			max-width: 900px;
			height: 90vh;
			display: flex;
			flex-direction: column;
			box-shadow: 0 25px 50px rgba(0, 0, 0, 0.3);
			animation: slideUp 0.4s ease-out;
		}

		.journal-write-header {
			display: flex;
			justify-content: space-between;
			align-items: center;
			padding: 20px 30px;
			border-bottom: 1px solid #e8eef5;
			background: linear-gradient(135deg, #f8fafc 0%, #fff 100%);
			border-radius: 20px 20px 0 0;
		}

		.journal-write-title {
			display: flex;
			flex-direction: column;
			gap: 8px;
		}

		.journal-write-date {
			font-size: 0.9rem;
			color: #8b94a5;
			font-weight: 500;
			letter-spacing: 0.3px;
		}

		.journal-write-mood-selector {
			display: flex;
			gap: 8px;
		}

		.journal-write-mood-btn {
			font-size: 1.5rem;
			background: none;
			border: 2px solid #e0e7ef;
			border-radius: 50%;
			width: 42px;
			height: 42px;
			cursor: pointer;
			transition: all 0.2s ease;
			display: flex;
			align-items: center;
			justify-content: center;
		}

		.journal-write-mood-btn:hover {
			transform: scale(1.15);
		}

		.journal-write-mood-btn.selected {
			border-color: #4056a1;
			background: #f0f3f7;
		}

		.journal-write-close {
			background: none;
			border: none;
			font-size: 1.8rem;
			cursor: pointer;
			color: #8b94a5;
			padding: 0;
			width: 40px;
			height: 40px;
			display: flex;
			align-items: center;
			justify-content: center;
			transition: all 0.2s ease;
		}

		.journal-write-close:hover {
			color: #2b3a67;
			transform: scale(1.1);
		}

		.journal-write-toolbar {
			display: flex;
			gap: 8px;
			padding: 12px 30px;
			background: #f8fafc;
			border-bottom: 1px solid #e8eef5;
			flex-wrap: wrap;
			align-items: center;
		}

		.toolbar-section {
			display: flex;
			gap: 4px;
			align-items: center;
			border-right: 1px solid #e0e7ef;
			padding-right: 8px;
		}

		.toolbar-section:last-child {
			border-right: none;
		}

		.toolbar-btn {
			background: #fff;
			border: 1px solid #e0e7ef;
			color: #4056a1;
			padding: 8px 12px;
			border-radius: 6px;
			cursor: pointer;
			font-size: 0.85rem;
			font-weight: 500;
			transition: all 0.2s ease;
			display: flex;
			align-items: center;
			gap: 4px;
		}

		.toolbar-btn:hover {
			background: #4056a1;
			color: #fff;
			border-color: #4056a1;
		}

		.toolbar-btn.active {
			background: #4056a1;
			color: #fff;
		}

		.toolbar-separator {
			width: 1px;
			height: 20px;
			background: #e0e7ef;
			margin: 0 4px;
		}

		.journal-write-content {
			flex: 1;
			display: flex;
			overflow: hidden;
		}

		.journal-editor-area {
			flex: 1;
			display: flex;
			flex-direction: column;
			padding: 30px;
			overflow-y: auto;
		}

		#journalWriteText {
			flex: 1;
			border: none;
			outline: none;
			font-family: 'Georgia', serif;
			font-size: 1.05rem;
			line-height: 1.8;
			color: #2b3a67;
			resize: none;
			caret-color: #4056a1;
		}

		#journalWriteText::placeholder {
			color: #cbd5e1;
			font-style: italic;
		}

		.journal-editor-preview {
			flex: 1;
			padding: 30px;
			overflow-y: auto;
			background: #f8fafc;
			border-left: 1px solid #e8eef5;
		}

		.journal-write-preview {
			font-family: 'Georgia', serif;
			font-size: 1.05rem;
			line-height: 1.8;
			color: #2b3a67;
		}

		.journal-write-preview h1 {
			font-size: 1.8rem;
			font-weight: 700;
			margin: 1.5em 0 0.5em 0;
		}

		.journal-write-preview h2 {
			font-size: 1.5rem;
			font-weight: 700;
			margin: 1.3em 0 0.4em 0;
		}

		.journal-write-preview h3 {
			font-size: 1.2rem;
			font-weight: 700;
			margin: 1.1em 0 0.3em 0;
		}

		.journal-write-preview ul, .journal-write-preview ol {
			margin: 1em 0;
			padding-left: 2em;
		}

		.journal-write-preview li {
			margin: 0.3em 0;
		}

		.journal-write-preview img {
			max-width: 100%;
			height: auto;
			border-radius: 8px;
			margin: 1em 0;
		}

		.journal-write-preview blockquote {
			border-left: 4px solid #4056a1;
			padding-left: 1em;
			margin: 1em 0;
			color: #4f5d75;
			font-style: italic;
		}

		.journal-image-insert {
			display: none;
		}

		.journal-image-preview {
			max-width: 100%;
			max-height: 300px;
			margin: 12px 0;
			border-radius: 8px;
		}

		.journal-write-footer {
			display: flex;
			justify-content: space-between;
			align-items: center;
			padding: 15px 30px;
			background: #f8fafc;
			border-top: 1px solid #e8eef5;
			border-radius: 0 0 20px 20px;
		}

		.journal-write-stats {
			display: flex;
			gap: 20px;
			font-size: 0.85rem;
			color: #8b94a5;
		}

		.journal-write-stat {
			display: flex;
			align-items: center;
			gap: 4px;
		}

		.journal-write-actions {
			display: flex;
			gap: 12px;
		}

		.journal-write-save {
			background: #4056a1;
			color: #fff;
			border: none;
			padding: 10px 24px;
			border-radius: 8px;
			cursor: pointer;
			font-weight: 600;
			transition: all 0.2s ease;
		}

		.journal-write-save:hover {
			background: #2b3a67;
			transform: translateY(-2px);
			box-shadow: 0 5px 15px rgba(43, 58, 103, 0.3);
		}

		.journal-write-cancel {
			background: #e0e7ef;
			color: #2b3a67;
			border: none;
			padding: 10px 24px;
			border-radius: 8px;
			cursor: pointer;
			font-weight: 600;
			transition: all 0.2s ease;
		}

		.journal-write-cancel:hover {
			background: #cbd5e1;
		}

		.journal-auto-save {
			font-size: 0.8rem;
			color: #8b94a5;
			display: flex;
			align-items: center;
			gap: 6px;
		}

		.journal-auto-save.saved {
			color: #10b981;
		}

		/* Scrollbar */
		::-webkit-scrollbar {
			width: 8px;
		}

		::-webkit-scrollbar-track {
			background: #f8fafc;
			border-radius: 10px;
		}

		::-webkit-scrollbar-thumb {
			background: #cbd5e1;
			border-radius: 10px;
		}

		::-webkit-scrollbar-thumb:hover {
			background: #9ca3af;
		}
	</style>
</head>
<body>
	<div class="container">
		<!-- Header -->
		<div class="header">
			<h1>üìÖ Joureli Calendar</h1>
			<p>Plan, schedule, and organize your time</p>
		</div>

		<!-- View Toggle -->
		<div class="view-toggle">
			<button class="toggle-btn active" onclick="switchView('calendar')">üìÖ Calendar Mode</button>
			<button class="toggle-btn" onclick="switchView('timeline')">üìà Timeline Mode</button>
		</div>

		<!-- Main Layout -->
		<div class="layout">
			<!-- Calendar View -->
			<div class="calendar-wrapper active">
				<div class="calendar-header">
					<button class="nav-btn" onclick="previousMonth()">‚Üê Previous</button>
					<h2 id="monthYear"></h2>
					<button class="nav-btn today-btn" onclick="goToToday()">Today</button>
					<button class="nav-btn" onclick="nextMonth()">Next ‚Üí</button>
				</div>

				<div class="weekdays">
					<div class="weekday">Sun</div>
					<div class="weekday">Mon</div>
					<div class="weekday">Tue</div>
					<div class="weekday">Wed</div>
					<div class="weekday">Thu</div>
					<div class="weekday">Fri</div>
					<div class="weekday">Sat</div>
				</div>

				<div class="calendar-grid" id="calendarGrid"></div>
			</div>

			<!-- Timeline View -->
			<div class="timeline-wrapper">
				<div class="calendar-header">
					<h2>üìà Event Timeline</h2>
				</div>
				<div class="timeline" id="timelineContainer"></div>
			</div>

			<!-- Sidebar -->
			<div class="sidebar">
				<!-- Sidebar Tabs -->
				<div class="sidebar-tabs">
					<button class="sidebar-tab active" onclick="switchSidebarTab('events')">üìÖ Events</button>
					<button class="sidebar-tab" onclick="switchSidebarTab('journal')">üìî Journal</button>
				</div>

				<!-- Events Tab -->
				<div class="sidebar-content active" id="eventsTab">
					<!-- Add Event Card -->
					<div class="sidebar-card">
						<h3>üìù New Event</h3>
						<form class="event-form" onsubmit="addEvent(event)">
							<div class="form-group">
								<label>Event Title</label>
								<input type="text" id="eventTitle" placeholder="e.g., Team Meeting" required>
							</div>

							<div class="form-group">
								<label>Start Date</label>
								<input type="date" id="eventDate" required>
							</div>

							<div class="form-group">
								<label>End Date (Optional)</label>
								<input type="date" id="eventEndDate">
							</div>

							<div class="form-group">
								<label>Time</label>
								<input type="time" id="eventTime">
							</div>

							<div class="form-group">
								<label>Description</label>
								<textarea id="eventDesc" placeholder="Add details..." style="resize: none; height: 60px;"></textarea>
							</div>

							<div class="form-group">
								<label>Category</label>
								<select id="eventCategory">
									<option value="work">Work</option>
									<option value="personal">Personal</option>
									<option value="health">Health</option>
									<option value="social">Social</option>
									<option value="other">Other</option>
								</select>
							</div>

							<button type="submit" class="add-event-btn">+ Add Event</button>
						</form>
					</div>

					<!-- Upcoming Events -->
					<div class="sidebar-card">
						<h3>üìÜ Upcoming Events</h3>
						<div class="upcoming-events" id="upcomingEvents">
							<div class="empty-message">No upcoming events</div>
						</div>
					</div>
				</div>

				<!-- Journal Tab -->
				<div class="sidebar-content" id="journalTab">
					<!-- Journal Entry Card -->
					<div class="sidebar-card">
						<h3>üìî New Journal Entry</h3>
						<div class="form-group" style="margin-bottom: 12px;">
							<label>Date</label>
							<input type="date" id="journalDate" required>
						</div>
						<div class="form-group" style="margin-bottom: 12px;">
							<label>Tags (press Enter to add)</label>
							<div class="tags-input-container" id="tagsContainer">
								<input type="text" class="tags-input" id="tagsInput" placeholder="e.g., work, health, travel...">
							</div>
							<input type="hidden" id="journalTags">
						</div>
						<button type="button" class="add-event-btn" onclick="openJournalWriteModal()">‚úèÔ∏è Start Writing</button>
					</div>

					<!-- Day Review Card -->
					<div class="sidebar-card">
						<h3>üìÖ What Happened Today</h3>
						<div id="dayReview">
							<div class="empty-message">Select a date to review</div>
						</div>
					</div>

					<!-- Past Entries Card -->
					<div class="sidebar-card">
						<h3>üìö Past Entries</h3>
						<div id="pastEntries">
							<div class="empty-message">No entries yet</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<!-- Journal Writing Modal - Focus Mode -->
	<div class="journal-write-modal" id="journalWriteModal">
		<div class="journal-write-container">
			<!-- Header -->
			<div class="journal-write-header">
				<div class="journal-write-title">
					<div class="journal-write-date" id="writeDate">Today</div>
					<div style="font-size: 1.3rem; font-weight: 600; color: #2b3a67;">‚úèÔ∏è Your Thoughts</div>
				</div>
				<div class="journal-write-mood-selector" id="writeModalMoodSelector">
					<button type="button" class="journal-write-mood-btn" data-mood="üòä" title="Great">üòä</button>
					<button type="button" class="journal-write-mood-btn" data-mood="üòå" title="Good">üòå</button>
					<button type="button" class="journal-write-mood-btn" data-mood="üòê" title="Okay">üòê</button>
					<button type="button" class="journal-write-mood-btn" data-mood="üòî" title="Sad">üòî</button>
					<button type="button" class="journal-write-mood-btn" data-mood="üò§" title="Frustrated">üò§</button>
				</div>
				<button class="journal-write-close" onclick="closeJournalWriteModal()">√ó</button>
			</div>

			<!-- Toolbar -->
			<div class="journal-write-toolbar">
				<div class="toolbar-section">
					<button type="button" class="toolbar-btn" title="Bold (Ctrl+B)" onclick="insertMarkdown('**', '**')">
						<span style="font-weight: bold;">B</span>
					</button>
					<button type="button" class="toolbar-btn" title="Italic (Ctrl+I)" onclick="insertMarkdown('_', '_')">
						<span style="font-style: italic;">I</span>
					</button>
					<button type="button" class="toolbar-btn" title="Underline" onclick="insertMarkdown('<u>', '</u>')">
						<span style="text-decoration: underline;">U</span>
					</button>
				</div>

				<div class="toolbar-section">
					<button type="button" class="toolbar-btn" title="Heading 1" onclick="insertMarkdown('# ', '')">H1</button>
					<button type="button" class="toolbar-btn" title="Heading 2" onclick="insertMarkdown('## ', '')">H2</button>
					<button type="button" class="toolbar-btn" title="Heading 3" onclick="insertMarkdown('### ', '')">H3</button>
				</div>

				<div class="toolbar-section">
					<button type="button" class="toolbar-btn" title="Bullet List" onclick="insertMarkdown('‚Ä¢ ', '')">‚Ä¢ List</button>
					<button type="button" class="toolbar-btn" title="Numbered List" onclick="insertMarkdown('1. ', '')">1. List</button>
					<button type="button" class="toolbar-btn" title="Quote" onclick="insertMarkdown('> ', '')">Quote</button>
				</div>

				<div class="toolbar-section">
					<button type="button" class="toolbar-btn" title="Insert Link" onclick="insertLink()">üîó Link</button>
					<button type="button" class="toolbar-btn" onclick="document.getElementById('journalImageInsert').click()">
						üñºÔ∏è Image
					</button>
					<input type="file" id="journalImageInsert" class="journal-image-insert" accept="image/*" onchange="insertImage(event)">
				</div>

				<div class="toolbar-section">
					<button type="button" class="toolbar-btn" id="previewToggle" onclick="togglePreview()">üëÅÔ∏è Preview</button>
				</div>
			</div>

			<!-- Content Area -->
			<div class="journal-write-content">
				<div class="journal-editor-area">
					<textarea id="journalWriteText" placeholder="Write freely. Express yourself. No judgment, no limits..."></textarea>
				</div>
				<div class="journal-editor-preview" id="previewArea" style="display: none;">
					<div class="journal-write-preview" id="previewContent"></div>
				</div>
			</div>

			<!-- Footer -->
			<div class="journal-write-footer">
				<div class="journal-write-stats">
					<div class="journal-write-stat">
						<span>üìä</span>
						<span id="writeWordCount">0 words</span>
					</div>
					<div class="journal-write-stat">
						<span>üî§</span>
						<span id="writeCharCount">0 characters</span>
					</div>
					<div class="journal-auto-save" id="autoSaveIndicator">
						<span>‚è±Ô∏è</span>
						<span>Saving...</span>
					</div>
				</div>

				<div class="journal-write-actions">
					<button class="journal-write-cancel" onclick="closeJournalWriteModal()">Discard</button>
					<button class="journal-write-save" onclick="saveFromWriteModal()">Save Entry</button>
				</div>
			</div>
		</div>
	</div>

	<!-- Event Details/Edit Modal -->
	<div class="modal" id="eventModal">
		<div class="modal-content">
			<div class="modal-header">
				<h2 id="modalTitle">Event Details</h2>
				<button class="close-btn" onclick="closeModal()">√ó</button>
			</div>
			<div class="modal-body" id="modalBody"></div>
			<div class="modal-footer">
				<button class="modal-btn modal-btn-danger" onclick="deleteEvent()">Delete</button>
				<button class="modal-btn modal-btn-secondary" onclick="closeModal()">Close</button>
			</div>
		</div>
	</div>

	<script>
		let currentDate = new Date();
		let events = JSON.parse(localStorage.getItem('joureviEvents')) || [];
		let journals = JSON.parse(localStorage.getItem('joureviJournals')) || [];
		let selectedEventId = null;
		let isEditMode = false;
		let currentView = 'calendar';
		let currentSidebarTab = 'events';
		let currentMood = null;
		let currentTags = [];

		const COLORS = {
			work: '#4056a1',
			personal: '#8b5cf6',
			health: '#10b981',
			social: '#f59e0b',
			other: '#6b7280'
		};

		function initializeCalendar() {
			const today = new Date();
			document.getElementById('eventDate').valueAsDate = today;
			document.getElementById('journalDate').valueAsDate = today;
			renderCalendar();
			renderTimeline();
			renderUpcomingEvents();
			renderDayReview(today);
			renderPastEntries();
			setupMoodSelector();
			setupTagsInput();
		}

		function setupMoodSelector() {
			document.querySelectorAll('.mood-btn').forEach(btn => {
				btn.addEventListener('click', (e) => {
					e.preventDefault();
					document.querySelectorAll('.mood-btn').forEach(b => b.classList.remove('selected'));
					btn.classList.add('selected');
					currentMood = btn.getAttribute('data-mood');
					document.getElementById('journalMood').value = currentMood;
				});
			});
		}

		function setupTagsInput() {
			const input = document.getElementById('tagsInput');
			input.addEventListener('keypress', (e) => {
				if (e.key === 'Enter') {
					e.preventDefault();
					const tag = input.value.trim().toLowerCase();
					if (tag && !currentTags.includes(tag)) {
						currentTags.push(tag);
						renderTags();
						input.value = '';
						updateTagsField();
					}
				}
			});
		}

		function renderTags() {
			const container = document.getElementById('tagsContainer');
			const input = container.querySelector('.tags-input');
			container.innerHTML = '';
			currentTags.forEach(tag => {
				const badge = document.createElement('div');
				badge.className = 'tag-badge';
				badge.innerHTML = `${tag} <span class="tag-badge-remove" onclick="removeTag('${tag}')">√ó</span>`;
				container.appendChild(badge);
			});
			container.appendChild(input);
		}

		function removeTag(tag) {
			currentTags = currentTags.filter(t => t !== tag);
			renderTags();
			updateTagsField();
		}

		function updateTagsField() {
			document.getElementById('journalTags').value = JSON.stringify(currentTags);
		}

		function switchSidebarTab(tab) {
			currentSidebarTab = tab;
			document.querySelectorAll('.sidebar-tab').forEach(btn => btn.classList.remove('active'));
			document.querySelectorAll('.sidebar-content').forEach(el => el.classList.remove('active'));
			
			if (tab === 'events') {
				document.querySelector('.sidebar-tab:nth-child(1)').classList.add('active');
				document.getElementById('eventsTab').classList.add('active');
			} else {
				document.querySelector('.sidebar-tab:nth-child(2)').classList.add('active');
				document.getElementById('journalTab').classList.add('active');
			}
		}

		function switchView(view) {
			currentView = view;
			document.querySelectorAll('.toggle-btn').forEach(btn => btn.classList.remove('active'));
			document.querySelectorAll('.calendar-wrapper, .timeline-wrapper').forEach(el => el.classList.remove('active'));

			if (view === 'calendar') {
				document.querySelector('.toggle-btn:first-child').classList.add('active');
				document.querySelector('.calendar-wrapper').classList.add('active');
				renderCalendar();
			} else {
				document.querySelector('.toggle-btn:last-child').classList.add('active');
				document.querySelector('.timeline-wrapper').classList.add('active');
				renderTimeline();
			}
		}

		function renderCalendar() {
			const year = currentDate.getFullYear();
			const month = currentDate.getMonth();

			document.getElementById('monthYear').textContent = currentDate.toLocaleDateString('en-US', {
				month: 'long',
				year: 'numeric'
			});

			const firstDay = new Date(year, month, 1);
			const lastDay = new Date(year, month + 1, 0);
			const startDate = new Date(firstDay);
			startDate.setDate(startDate.getDate() - firstDay.getDay());

			const grid = document.getElementById('calendarGrid');
			grid.innerHTML = '';

			let currentDateTemp = new Date(startDate);
			const dayElements = [];

			for (let i = 0; i < 42; i++) {
				const dayEl = document.createElement('div');
				dayEl.className = 'day';

				if (currentDateTemp.getMonth() !== month) {
					dayEl.classList.add('other-month');
				}

				const today = new Date();
				if (currentDateTemp.getFullYear() === today.getFullYear() &&
					currentDateTemp.getMonth() === today.getMonth() &&
					currentDateTemp.getDate() === today.getDate()) {
					dayEl.classList.add('today');
				}

				const dayDate = new Date(currentDateTemp);
				const dayNumber = currentDateTemp.getDate();
				const dateStr = dateToString(currentDateTemp);
				
				// Find events on this day (single-day and multi-day)
				const dayEvents = events.filter(e => {
					const eventStart = new Date(e.date);
					const eventEnd = new Date(e.endDate || e.date);
					const currentDay = new Date(dateStr);
					return currentDay >= eventStart && currentDay <= eventEnd;
				});

				// Separate single-day and multi-day events
				const singleDayEvents = dayEvents.filter(e => e.date === dateStr && (!e.endDate || e.endDate === e.date));
				const multiDayEvents = dayEvents.filter(e => e.endDate && e.endDate !== e.date);

				dayEl.innerHTML = `
					<div class="day-number">${dayNumber}</div>
					<div class="day-events">
						${singleDayEvents.slice(0, 2).map(e => `
							<div class="event-badge" style="background-color: ${COLORS[e.category]}; color: #fff;" onclick="viewEvent('${e.id}', event)">
								${e.title}
							</div>
						`).join('')}
						${singleDayEvents.length > 2 ? `<div class="event-count">+${singleDayEvents.length - 2} more</div>` : ''}
					</div>
				`;

				// Add multi-day event bars
				multiDayEvents.forEach(e => {
					const eventStart = new Date(e.date);
					const eventEnd = new Date(e.endDate);
					const isStart = dateStr === e.date;
					const isEnd = dateStr === e.endDate;
					
					const bar = document.createElement('div');
					bar.className = 'multi-day-event';
					if (isStart) bar.className += ' multi-day-event-start';
					if (isEnd) bar.className += ' multi-day-event-end';
					if (!isStart && !isEnd) bar.className += ' multi-day-event-middle';
					
					bar.style.setProperty('--event-color', COLORS[e.category]);
					bar.textContent = `${isStart ? '‚ñ∂ ' : ''}${e.title}${isEnd ? ' ‚óÄ' : ''}`;
					bar.onclick = (evt) => { evt.stopPropagation(); viewEvent(e.id); };
					dayEl.appendChild(bar);
				});

				dayEl.addEventListener('click', () => selectDate(dayDate));
				dayElements.push({ el: dayEl, dateStr });
				grid.appendChild(dayEl);

				currentDateTemp.setDate(currentDateTemp.getDate() + 1);
			}
		}

		function renderTimeline() {
			const sortedEvents = [...events]
				.sort((a, b) => {
					const dateA = new Date(a.date + ' ' + a.time);
					const dateB = new Date(b.date + ' ' + b.time);
					return dateA - dateB;
				});

			const container = document.getElementById('timelineContainer');

			if (sortedEvents.length === 0) {
				container.innerHTML = '<div class="empty-message">No events scheduled</div>';
				return;
			}

			// Group events by day
			const groupedByDay = {};
			sortedEvents.forEach(e => {
				if (!groupedByDay[e.date]) {
					groupedByDay[e.date] = [];
				}
				groupedByDay[e.date].push(e);
			});

			// Create timeline with day groups
			let html = '';
			Object.keys(groupedByDay).forEach(date => {
				const dayEvents = groupedByDay[date];
				const dateObj = new Date(date);
				const dateStr = dateObj.toLocaleDateString('en-US', { 
					weekday: 'long', 
					month: 'short', 
					day: 'numeric',
					year: 'numeric'
				});

				html += `<div class="timeline-day-group"><div class="timeline-day-header">üìÖ ${dateStr}</div>`;

				dayEvents.forEach((e, idx) => {
					html += `
						<div class="timeline-event">
							<div class="timeline-dot" style="border-color: ${COLORS[e.category]}; background: ${COLORS[e.category]};"></div>
							<div class="timeline-event-card" style="--border-color: ${COLORS[e.category]};">
								<div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 10px;">
									<div>
										${e.time !== '00:00' ? `<div class="timeline-event-time">‚è∞ ${e.time}</div>` : '<div class="timeline-event-time">üìå All Day</div>'}
										<div class="timeline-event-title">${e.title}</div>
									</div>
									<div class="timeline-event-category" style="background: ${COLORS[e.category]}; color: #fff;">${e.category}</div>
								</div>
								${e.description ? `<div class="timeline-event-desc">${e.description}</div>` : ''}
								<div class="timeline-event-actions">
									<button class="timeline-event-btn" onclick="viewEvent('${e.id}', event)">View</button>
									<button class="timeline-event-btn" onclick="editEvent('${e.id}', event)">Edit</button>
									<button class="timeline-event-btn" onclick="deleteEventById('${e.id}')">Delete</button>
								</div>
							</div>
						</div>
					`;
				});

				html += `</div>`;
			});

			container.innerHTML = html;

			// Apply border color to cards
			document.querySelectorAll('.timeline-event-card').forEach(card => {
				const borderColor = card.style.getPropertyValue('--border-color');
				if (borderColor) {
					card.style.borderLeftColor = borderColor;
				}
				const bar = card.querySelector('.timeline-event-card::before');
				if (borderColor) {
					card.style.setProperty('--border-left', borderColor);
				}
			});
		}

		function selectDate(date) {
			document.getElementById('eventDate').valueAsDate = date;
			document.getElementById('journalDate').valueAsDate = date;
			document.getElementById('eventTitle').focus();
			renderDayReview(date);
		}

		function previousMonth() {
			currentDate.setMonth(currentDate.getMonth() - 1);
			renderCalendar();
		}

		function nextMonth() {
			currentDate.setMonth(currentDate.getMonth() + 1);
			renderCalendar();
		}

		function goToToday() {
			currentDate = new Date();
			renderCalendar();
		}

		function dateToString(date) {
			const year = date.getFullYear();
			const month = String(date.getMonth() + 1).padStart(2, '0');
			const day = String(date.getDate()).padStart(2, '0');
			return `${year}-${month}-${day}`;
		}

		function addEvent(e) {
			e.preventDefault();

			const title = document.getElementById('eventTitle').value;
			const date = document.getElementById('eventDate').value;
			const endDate = document.getElementById('eventEndDate').value;
			const time = document.getElementById('eventTime').value;
			const desc = document.getElementById('eventDesc').value;
			const category = document.getElementById('eventCategory').value;

			if (!title || !date) return;

			// Validate date range
			if (endDate && new Date(endDate) < new Date(date)) {
				alert('End date must be after or equal to start date');
				return;
			}

			if (isEditMode && selectedEventId) {
				// Update existing event
				const eventIndex = events.findIndex(ev => ev.id === selectedEventId);
				if (eventIndex !== -1) {
					events[eventIndex].title = title;
					events[eventIndex].date = date;
					events[eventIndex].endDate = endDate || date;
					events[eventIndex].time = time || '00:00';
					events[eventIndex].description = desc;
					events[eventIndex].category = category;
				}
				isEditMode = false;
				selectedEventId = null;
			} else {
				// Add new event
				const event = {
					id: Date.now().toString(),
					title,
					date,
					endDate: endDate || date,
					time: time || '00:00',
					description: desc,
					category,
					createdAt: new Date().toISOString()
				};
				events.push(event);
			}

			saveEvents();
			renderCalendar();
			renderTimeline();
			renderUpcomingEvents();

			// Reset form
			document.getElementById('eventTitle').value = '';
			document.getElementById('eventTime').value = '';
			document.getElementById('eventDesc').value = '';
			document.getElementById('eventEndDate').value = '';

			const today = new Date();
			document.getElementById('eventDate').valueAsDate = today;
		}

		function renderUpcomingEvents() {
			const upcoming = events
				.filter(e => new Date(e.date) >= new Date(new Date().toISOString().split('T')[0]))
				.sort((a, b) => new Date(a.date) - new Date(b.date))
				.slice(0, 10);

			const container = document.getElementById('upcomingEvents');

			if (upcoming.length === 0) {
				container.innerHTML = '<div class="empty-message">No upcoming events</div>';
				return;
			}

			container.innerHTML = upcoming.map(e => `
				<div class="event-item" style="border-left-color: ${COLORS[e.category]}">
					<div class="event-item-title">${e.title}</div>
					<div class="event-item-date">
						${new Date(e.date).toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}
						${e.time !== '00:00' ? ` at ${e.time}` : ''}
					</div>
					<div class="event-item-actions">
						<button class="event-item-btn" onclick="viewEvent('${e.id}')">Details</button>
						<button class="event-item-btn" onclick="editEvent('${e.id}')">Edit</button>
					</div>
				</div>
			`).join('');
		}

		function viewEvent(eventId, e) {
			if (e) e.stopPropagation();
			selectedEventId = eventId;
			isEditMode = false;
			const event = events.find(ev => ev.id === eventId);

			if (!event) return;

			const startDate = new Date(event.date);
			const endDate = new Date(event.endDate || event.date);
			const isMultiDay = event.endDate && event.endDate !== event.date;
			const daysSpan = isMultiDay ? Math.ceil((endDate - startDate) / (1000 * 60 * 60 * 24)) + 1 : 1;

			const dateStr = startDate.toLocaleDateString('en-US', { 
				weekday: 'long', 
				year: 'numeric', 
				month: 'long', 
				day: 'numeric' 
			});

			const endDateStr = isMultiDay ? endDate.toLocaleDateString('en-US', { 
				weekday: 'long', 
				year: 'numeric', 
				month: 'long', 
				day: 'numeric' 
			}) : '';

			const modal = document.getElementById('eventModal');
			document.getElementById('modalTitle').textContent = event.title;
			document.getElementById('modalBody').innerHTML = `
				<div style="color: #4f5d75;">
					<p><strong>${isMultiDay ? 'Date Range:' : 'Date:'}</strong> ${dateStr}${isMultiDay ? ` ‚Üí ${endDateStr}` : ''}</p>
					${isMultiDay ? `<p><strong>Duration:</strong> ${daysSpan} day${daysSpan > 1 ? 's' : ''}</p>` : ''}
					<p><strong>Time:</strong> ${event.time !== '00:00' ? event.time : 'All day'}</p>
					<p><strong>Category:</strong> <span style="display: inline-block; background: ${COLORS[event.category]}; color: #fff; padding: 2px 8px; border-radius: 4px; text-transform: capitalize;">${event.category}</span></p>
					${event.description ? `<p><strong>Description:</strong> ${event.description}</p>` : ''}
				</div>
			`;

			modal.classList.add('active');
		}

		function editEvent(eventId, e) {
			if (e) e.stopPropagation();
			selectedEventId = eventId;
			isEditMode = true;
			const event = events.find(ev => ev.id === eventId);

			if (!event) return;

			document.getElementById('eventTitle').value = event.title;
			document.getElementById('eventDate').value = event.date;
			document.getElementById('eventEndDate').value = event.endDate || event.date;
			document.getElementById('eventTime').value = event.time;
			document.getElementById('eventDesc').value = event.description || '';
			document.getElementById('eventCategory').value = event.category;
			document.getElementById('eventTitle').focus();

			closeModal();
		}

		// Journal Write Modal Functions
		function openJournalWriteModal() {
			const date = new Date(document.getElementById('journalDate').value);
			const dateStr = date.toLocaleDateString('en-US', { 
				weekday: 'long', 
				month: 'long', 
				day: 'numeric' 
			});

			document.getElementById('writeDate').textContent = dateStr;
			document.getElementById('journalWriteText').value = '';
			document.getElementById('previewContent').innerHTML = '';
			document.getElementById('previewArea').style.display = 'none';
			document.getElementById('previewToggle').classList.remove('active');

			// Setup mood selector in write modal
			document.querySelectorAll('.journal-write-mood-btn').forEach(btn => {
				btn.classList.remove('selected');
				btn.addEventListener('click', (e) => {
					e.preventDefault();
					document.querySelectorAll('.journal-write-mood-btn').forEach(b => b.classList.remove('selected'));
					btn.classList.add('selected');
					currentMood = btn.getAttribute('data-mood');
				});
			});

			currentMood = null;
			document.getElementById('journalWriteText').focus();
			setupWriteModalStats();

			document.getElementById('journalWriteModal').classList.add('active');
		}

		function closeJournalWriteModal() {
			document.getElementById('journalWriteModal').classList.remove('active');
			currentMood = null;
		}

		function setupWriteModalStats() {
			const textarea = document.getElementById('journalWriteText');
			textarea.addEventListener('input', () => {
				const text = textarea.value;
				const words = text.trim() ? text.trim().split(/\s+/).length : 0;
				const chars = text.length;

				document.getElementById('writeWordCount').textContent = words + ' word' + (words !== 1 ? 's' : '');
				document.getElementById('writeCharCount').textContent = chars + ' character' + (chars !== 1 ? 's' : '');

				// Update preview if visible
				if (document.getElementById('previewArea').style.display !== 'none') {
					updatePreview();
				}
			});
		}

		function insertMarkdown(before, after) {
			const textarea = document.getElementById('journalWriteText');
			const start = textarea.selectionStart;
			const end = textarea.selectionEnd;
			const selectedText = textarea.value.substring(start, end);
			const beforeText = textarea.value.substring(0, start);
			const afterText = textarea.value.substring(end);

			const newText = beforeText + before + selectedText + after + afterText;
			textarea.value = newText;
			textarea.focus();
			textarea.selectionStart = start + before.length;
			textarea.selectionEnd = start + before.length + selectedText.length;

			// Trigger input event for stats update
			textarea.dispatchEvent(new Event('input'));
		}

		function insertLink() {
			const url = prompt('Enter URL:');
			if (!url) return;
			insertMarkdown('[', '](' + url + ')');
		}

		function insertImage(event) {
			const file = event.target.files[0];
			if (!file) return;

			const reader = new FileReader();
			reader.onload = (e) => {
				const imgData = e.target.result;
				const textarea = document.getElementById('journalWriteText');
				const start = textarea.selectionStart;
				const before = textarea.value.substring(0, start);
				const after = textarea.value.substring(start);

				textarea.value = before + '\n[Image inserted]\n' + after;
				textarea.focus();

				// Store image data
				if (!window.journalImages) window.journalImages = [];
				window.journalImages.push({ data: imgData, alt: file.name });

				// Show in preview if visible
				if (document.getElementById('previewArea').style.display !== 'none') {
					updatePreview();
				}

				textarea.dispatchEvent(new Event('input'));
			};
			reader.readAsDataURL(file);
		}

		function togglePreview() {
			const previewArea = document.getElementById('previewArea');
			const toggle = document.getElementById('previewToggle');

			if (previewArea.style.display === 'none') {
				previewArea.style.display = 'block';
				toggle.classList.add('active');
				updatePreview();
			} else {
				previewArea.style.display = 'none';
				toggle.classList.remove('active');
			}
		}

		function updatePreview() {
			const text = document.getElementById('journalWriteText').value;
			let html = markdownToHtml(text);
			document.getElementById('previewContent').innerHTML = html;
		}

		function markdownToHtml(text) {
			let html = text;

			// Headers
			html = html.replace(/^### (.*?)$/gm, '<h3>$1</h3>');
			html = html.replace(/^## (.*?)$/gm, '<h2>$1</h2>');
			html = html.replace(/^# (.*?)$/gm, '<h1>$1</h1>');

			// Bold
			html = html.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');

			// Italic
			html = html.replace(/_(.*?)_/g, '<em>$1</em>');

			// Blockquote
			html = html.replace(/^> (.*?)$/gm, '<blockquote>$1</blockquote>');

			// Lists
			html = html.replace(/^\‚Ä¢ (.*?)$/gm, '<li>$1</li>');
			html = html.replace(/^\d+\. (.*?)$/gm, '<li>$1</li>');

			// Line breaks
			html = html.replace(/\n/g, '<br>');

			// Links
			html = html.replace(/\[(.*?)\]\((.*?)\)/g, '<a href="$2" target="_blank">$1</a>');

			// Images from inserted images
			if (window.journalImages && window.journalImages.length > 0) {
				window.journalImages.forEach(img => {
					html = html.replace('[Image inserted]', `<img src="${img.data}" alt="${img.alt}" class="journal-image-preview">`);
				});
			}

			return html;
		}

		function saveFromWriteModal() {
			const date = document.getElementById('journalDate').value;
			const text = document.getElementById('journalWriteText').value;
			const mood = currentMood || 'üìù';
			const tags = [...currentTags];

			if (!date || !text.trim()) {
				alert('Please write something before saving.');
				return;
			}

			const entry = {
				id: Date.now().toString(),
				date,
				text,
				mood,
				tags,
				createdAt: new Date().toISOString()
			};

			journals.push(entry);
			saveJournals();

			// Reset
			closeJournalWriteModal();
			currentMood = null;
			currentTags = [];
			window.journalImages = [];
			document.getElementById('tagsContainer').innerHTML = '<input type="text" class="tags-input" id="tagsInput" placeholder="e.g., work, health, travel...">';
			setupTagsInput();

			// Refresh views
			renderDayReview(new Date(date));
			renderPastEntries();
		}

		function renderDayReview(date) {
			const dateStr = dateToString(date);
			const dayEvents = events.filter(e => {
				const eventStart = new Date(e.date);
				const eventEnd = new Date(e.endDate || e.date);
				const currentDay = new Date(dateStr);
				return currentDay >= eventStart && currentDay <= eventEnd;
			});

			const container = document.getElementById('dayReview');
			const dateDisplay = date.toLocaleDateString('en-US', { 
				weekday: 'long', 
				month: 'short', 
				day: 'numeric' 
			});

			if (dayEvents.length === 0) {
				container.innerHTML = `<div class="journal-day-header">${dateDisplay}</div><div class="empty-message">No events scheduled</div>`;
				return;
			}

			let html = `<div class="journal-day-header">${dateDisplay}</div><div class="journal-day-events">`;
			dayEvents.forEach(e => {
				html += `
					<div class="journal-day-event">
						<div class="journal-day-event-badge" style="background-color: ${COLORS[e.category]};"></div>
						<div class="journal-day-event-text">
							<strong>${e.title}</strong>
							${e.time !== '00:00' ? ` at ${e.time}` : ' (All day)'}
						</div>
					</div>
				`;
			});
			html += `</div>`;
			container.innerHTML = html;
		}

		function renderPastEntries() {
			const sortedJournals = [...journals].sort((a, b) => new Date(b.date) - new Date(a.date)).slice(0, 8);
			const container = document.getElementById('pastEntries');

			if (sortedJournals.length === 0) {
				container.innerHTML = '<div class="journal-no-entries">No entries yet. Start your first entry above.</div>';
				return;
			}

			let html = '';
			let currentDateGroup = null;

			sortedJournals.forEach(entry => {
				const entryDate = new Date(entry.date);
				const dateParts = entryDate.toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' }).split(' ');
				const dayOfWeek = entryDate.toLocaleDateString('en-US', { weekday: 'short' });
				const dateStr = `${dayOfWeek}, ${dateParts[0]} ${dateParts[1]}`;

				// Add date header if changed
				if (currentDateGroup !== entry.date) {
					if (currentDateGroup !== null) html += '</div>';
					html += `<div class="journal-day-header">${dateStr}</div>`;
					currentDateGroup = entry.date;
				}

				const wordCount = entry.text.trim().split(/\s+/).length;
				const readTime = Math.ceil(wordCount / 200); // avg 200 words per minute
				const preview = entry.text.substring(0, 90) + (entry.text.length > 90 ? '...' : '');

				html += `
					<div class="journal-entry">
						<div class="journal-entry-header">
							<div class="journal-entry-date">${dateStr}</div>
							<div class="journal-entry-mood">${entry.mood || 'üìù'}</div>
						</div>
						${entry.tags && entry.tags.length > 0 ? `
							<div class="journal-entry-tags">
								${entry.tags.map(tag => `<span class="journal-entry-tag">#${tag}</span>`).join('')}
							</div>
						` : ''}
						<div class="journal-entry-text">${preview}</div>
						<div class="journal-entry-meta">
							<div class="journal-entry-stats">
								<div class="journal-entry-stat">
									<span>üìä</span>
									<span>${wordCount} words</span>
								</div>
								<div class="journal-entry-stat">
									<span>‚è±Ô∏è</span>
									<span>${readTime} min read</span>
								</div>
							</div>
						</div>
						<div class="journal-entry-actions">
							<button class="journal-entry-btn" onclick="viewJournalEntry('${entry.id}')">Read</button>
							<button class="journal-entry-btn" onclick="editJournalEntry('${entry.id}')">Edit</button>
							<button class="journal-entry-btn" onclick="deleteJournalEntry('${entry.id}')">Delete</button>
						</div>
					</div>
				`;
			});
			if (currentDateGroup !== null) html += '</div>';

			container.innerHTML = html;
		}

		function viewJournalEntry(entryId) {
			const entry = journals.find(j => j.id === entryId);
			if (!entry) return;

			const entryDate = new Date(entry.date);
			const dateStr = entryDate.toLocaleDateString('en-US', { 
				weekday: 'long', 
				year: 'numeric', 
				month: 'long', 
				day: 'numeric' 
			});

			const wordCount = entry.text.trim().split(/\s+/).length;
			const readTime = Math.ceil(wordCount / 200);
			const charCount = entry.text.length;

			const modal = document.getElementById('eventModal');
			document.getElementById('modalTitle').textContent = entry.mood + ' Journal Entry';
			document.getElementById('modalBody').innerHTML = `
				<div style="color: #4f5d75;">
					<p style="font-size: 1.1rem; font-weight: 600; color: #2b3a67; margin-bottom: 12px;">${dateStr}</p>
					${entry.tags && entry.tags.length > 0 ? `
						<div style="margin-bottom: 16px; display: flex; gap: 6px; flex-wrap: wrap;">
							${entry.tags.map(tag => `<span style="background: #f0f3f7; color: #4056a1; padding: 4px 10px; border-radius: 16px; font-size: 0.85rem; font-weight: 500;">#${tag}</span>`).join('')}
						</div>
					` : ''}
					<div style="display: flex; gap: 20px; margin-bottom: 20px; padding: 12px; background: #f8fafc; border-radius: 8px; font-size: 0.9rem;">
						<div><strong>üìä Words:</strong> ${wordCount}</div>
						<div><strong>‚è±Ô∏è Read time:</strong> ${readTime} min</div>
						<div><strong>üî§ Characters:</strong> ${charCount}</div>
					</div>
					<p style="margin-top: 15px; white-space: pre-wrap; line-height: 1.8; font-size: 0.95rem; color: #3a3a3a;">${entry.text}</p>
				</div>
			`;

			const footer = document.querySelector('.modal-footer');
			footer.innerHTML = `
				<button class="modal-btn modal-btn-danger" onclick="deleteJournalEntry('${entry.id}')">Delete</button>
				<button class="modal-btn modal-btn-secondary" onclick="closeModal()">Close</button>
			`;

			modal.classList.add('active');
		}

		function editJournalEntry(entryId) {
			const entry = journals.find(j => j.id === entryId);
			if (!entry) return;

			document.getElementById('journalDate').value = entry.date;
			document.getElementById('journalWriteText').value = entry.text;

			// Load mood
			currentMood = entry.mood || null;
			document.querySelectorAll('.journal-write-mood-btn').forEach(b => b.classList.remove('selected'));
			if (currentMood) {
				const moodBtn = document.querySelector(`.journal-write-mood-btn[data-mood="${currentMood}"]`);
				if (moodBtn) moodBtn.classList.add('selected');
			}

			// Load tags
			currentTags = entry.tags && entry.tags.length > 0 ? [...entry.tags] : [];
			renderTags();
			updateTagsField();

			// Delete the entry (will be re-saved as new)
			journals = journals.filter(j => j.id !== entryId);
			saveJournals();

			// Open write modal
			closeModal();
			switchSidebarTab('journal');
			
			setTimeout(() => {
				openJournalWriteModal();
				document.getElementById('journalWriteText').focus();
				renderPastEntries();
			}, 100);
		}

		function deleteJournalEntry(entryId) {
			if (confirm('Are you sure you want to delete this entry?')) {
				journals = journals.filter(j => j.id !== entryId);
				saveJournals();
				renderPastEntries();
				closeModal();
			}
		}

		function saveJournals() {
			localStorage.setItem('joureviJournals', JSON.stringify(journals));
		}

		function closeModal() {
			document.getElementById('eventModal').classList.remove('active');
			selectedEventId = null;
		}

		function deleteEvent() {
			if (selectedEventId) {
				deleteEventById(selectedEventId);
			}
		}

		function deleteEventById(eventId) {
			events = events.filter(e => e.id !== eventId);
			saveEvents();
			renderCalendar();
			renderTimeline();
			renderUpcomingEvents();
			closeModal();
		}

		function saveEvents() {
			localStorage.setItem('joureviEvents', JSON.stringify(events));
		}

		// Close modal when clicking outside
		document.getElementById('eventModal').addEventListener('click', (e) => {
			if (e.target.id === 'eventModal') {
				closeModal();
			}
		});

		// Initialize
		initializeCalendar();
	</script>
</body>
</html>
