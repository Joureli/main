<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Joureli - Journal, Calendar & Planning</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #2b3a67;
            --primary-light: #4056a1;
            --primary-dark: #1a2543;
            --accent: #6366f1;
            --accent-light: #818cf8;
            --bg-light: #f8fafc;
            --bg-lighter: #f1f5f9;
            --border: #e2e8f0;
            --text-primary: #1e293b;
            --text-secondary: #64748b;
            --text-muted: #94a3b8;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', sans-serif;
            background: linear-gradient(135deg, var(--bg-light) 0%, #eff2f8 100%);
            color: var(--text-primary);
            min-height: 100vh;
            padding: 16px;
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        /* Header */
        .header {
            text-align: center;
            margin-bottom: 32px;
            animation: slideDown 0.6s ease-out;
            padding: 24px 0;
        }

        .header h1 {
            font-size: 3rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 8px;
            letter-spacing: -1px;
        }

        .header p {
            color: var(--text-secondary);
            font-size: 1rem;
            margin-bottom: 20px;
            font-weight: 500;
        }

        /* View Toggle */
        .view-toggle {
            display: flex;
            gap: 12px;
            justify-content: center;
            margin-bottom: 28px;
            flex-wrap: wrap;
        }

        .toggle-btn {
            padding: 10px 28px;
            border: 2px solid var(--border);
            background: #fff;
            color: var(--text-primary);
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 0.95rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
        }

        .toggle-btn:hover {
            border-color: var(--primary-light);
            background: #fff;
            box-shadow: 0 4px 12px rgba(64, 86, 161, 0.15);
            transform: translateY(-1px);
        }

        .toggle-btn.active {
            background: var(--primary-light);
            color: #fff;
            border-color: var(--primary-light);
            box-shadow: 0 8px 24px rgba(64, 86, 161, 0.3);
        }

        /* Main Layout */
        .layout {
            display: grid;
            grid-template-columns: 1fr 360px;
            gap: 24px;
            margin-bottom: 32px;
        }

        /* Calendar Wrapper */
        .calendar-wrapper {
            background: #fff;
            border-radius: 16px;
            padding: 28px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
            border: 1px solid var(--border);
            display: none;
            animation: fadeIn 0.4s ease-out;
        }

        .calendar-wrapper.active {
            display: block;
        }

        /* Timeline Wrapper */
        .timeline-wrapper {
            background: #fff;
            border-radius: 16px;
            padding: 28px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
            border: 1px solid var(--border);
            display: none;
            animation: fadeIn 0.4s ease-out;
        }

        .timeline-wrapper.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        /* Calendar Header */
        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 28px;
            gap: 20px;
            flex-wrap: wrap;
        }

        .calendar-header h2 {
            font-size: 1.75rem;
            font-weight: 700;
            color: var(--text-primary);
            min-width: 200px;
            text-align: center;
        }

        .calendar-nav {
            display: flex;
            gap: 8px;
        }

        .nav-btn {
            background: var(--primary);
            color: #fff;
            border: none;
            padding: 10px 22px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 0.9rem;
            font-weight: 600;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .nav-btn:hover {
            background: var(--primary-light);
            transform: translateY(-2px);
            box-shadow: 0 8px 16px rgba(64, 86, 161, 0.25);
        }

        .nav-btn:active {
            transform: translateY(0);
        }

        .today-btn {
            background: var(--primary-light);
        }

        /* Timeline */
        .timeline {
            position: relative;
            padding: 0;
        }

        .timeline::before {
            content: '';
            position: absolute;
            left: 40px;
            top: 0;
            bottom: 0;
            width: 3px;
            background: linear-gradient(180deg, var(--primary-light) 0%, var(--accent-light) 50%, var(--success) 100%);
            border-radius: 10px;
        }

        .timeline-day-group {
            margin-bottom: 44px;
        }

        .timeline-day-header {
            font-weight: 700;
            font-size: 0.95rem;
            color: var(--text-primary);
            margin-bottom: 24px;
            padding-left: 100px;
            text-transform: uppercase;
            letter-spacing: 0.8px;
            opacity: 0.7;
        }

        .timeline-event {
            margin-bottom: 28px;
            padding-left: 100px;
            position: relative;
            animation: fadeInUp 0.5s ease-out forwards;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .timeline-event:nth-child(1) {
            animation-delay: 0.05s;
        }

        .timeline-event:nth-child(2) {
            animation-delay: 0.1s;
        }

        .timeline-event:nth-child(3) {
            animation-delay: 0.15s;
        }

        .timeline-event:nth-child(4) {
            animation-delay: 0.2s;
        }

        .timeline-event:nth-child(5) {
            animation-delay: 0.25s;
        }

        .timeline-dot {
            position: absolute;
            left: 25px;
            top: 12px;
            width: 32px;
            height: 32px;
            background: #fff;
            border: 4px solid;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 0.7rem;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 2;
        }

        .timeline-event:hover .timeline-dot {
            transform: scale(1.15);
            box-shadow: 0 0 20px rgba(64, 86, 161, 0.3);
        }

        .timeline-event-card {
            background: #fff;
            padding: 20px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
            border: 2px solid transparent;
            position: relative;
            overflow: hidden;
        }

        .timeline-event-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
        }

        .timeline-event-card:hover {
            transform: translateX(6px) translateY(-2px);
            box-shadow: 0 12px 32px rgba(0, 0, 0, 0.12);
            border-color: var(--border);
        }

        .timeline-event-time {
            font-size: 0.8rem;
            font-weight: 700;
            color: var(--primary-light);
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.6px;
        }

        .timeline-event-title {
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 8px;
            font-size: 1.1rem;
        }

        .timeline-event-category {
            display: inline-block;
            font-size: 0.7rem;
            font-weight: 700;
            padding: 5px 12px;
            border-radius: 20px;
            text-transform: uppercase;
            letter-spacing: 0.6px;
            margin-bottom: 12px;
            background: var(--bg-lighter);
            color: var(--text-secondary);
        }

        .timeline-event-desc {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-bottom: 12px;
            line-height: 1.6;
        }

        .timeline-event-actions {
            display: flex;
            gap: 8px;
            padding-top: 12px;
            border-top: 1px solid var(--border);
        }

        .timeline-event-btn {
            background: var(--bg-lighter);
            border: 1px solid var(--border);
            color: var(--text-primary);
            cursor: pointer;
            font-size: 0.85rem;
            padding: 6px 14px;
            border-radius: 8px;
            transition: all 0.2s ease;
            font-weight: 600;
        }

        .timeline-event-btn:hover {
            background: var(--primary);
            color: #fff;
            border-color: var(--primary);
            transform: translateY(-2px);
        }

        /* Weekdays */
        .weekdays {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 10px;
            margin-bottom: 12px;
        }

        .weekday {
            text-align: center;
            font-weight: 700;
            color: var(--primary-light);
            padding: 12px 8px;
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 0.4px;
        }

        /* Calendar Grid */
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 10px;
        }

        .day {
            aspect-ratio: 1;
            background: var(--bg-lighter);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 10px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            flex-direction: column;
            position: relative;
            overflow: hidden;
            min-height: 120px;
        }

        .day:hover {
            background: #fff;
            border-color: var(--primary-light);
            box-shadow: 0 8px 24px rgba(64, 86, 161, 0.15);
            transform: translateY(-2px);
        }

        .day.other-month {
            background: var(--bg-light);
            color: var(--text-muted);
            opacity: 0.5;
        }

        .day.today {
            background: linear-gradient(135deg, var(--primary-light) 0%, var(--primary) 100%);
            color: #fff;
            border-color: var(--primary);
            box-shadow: 0 8px 24px rgba(64, 86, 161, 0.25);
        }

        .day-number {
            font-weight: 700;
            font-size: 1rem;
            margin-bottom: 6px;
            color: inherit;
        }

        .day-events {
            flex: 1;
            overflow-y: auto;
            font-size: 0.75rem;
        }

        .event-badge {
            background: var(--bg-light);
            color: var(--text-primary);
            padding: 3px 7px;
            border-radius: 5px;
            margin-bottom: 3px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            cursor: pointer;
            transition: all 0.2s ease;
            font-weight: 500;
        }

        .today .event-badge {
            background: rgba(255, 255, 255, 0.25);
            color: #fff;
        }

        .event-badge:hover {
            background: var(--primary-light);
            color: #fff;
        }

        .event-count {
            font-size: 0.7rem;
            color: var(--text-muted);
            margin-top: 4px;
            font-weight: 600;
        }

        /* Multi-day event styles */
        .multi-day-event {
            position: absolute;
            top: 5px;
            left: 5px;
            right: 5px;
            padding: 7px 10px;
            border-radius: 6px;
            font-size: 0.75rem;
            font-weight: 700;
            color: #fff;
            cursor: pointer;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 3;
            background: linear-gradient(90deg, var(--event-color, var(--primary-light)), rgba(64, 86, 161, 0.65));
            border: 1px solid rgba(255, 255, 255, 0.25);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .multi-day-event:hover {
            transform: scaleY(1.05);
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.15);
        }

        .day.multi-day-event-start {
            border-top-right-radius: 0;
            border-bottom-right-radius: 0;
        }

        .day.multi-day-event-middle {
            border-radius: 0;
        }

        .day.multi-day-event-end {
            border-top-left-radius: 0;
            border-bottom-left-radius: 0;
        }

        /* Sidebar */
        .sidebar {
            display: flex;
            flex-direction: column;
            gap: 24px;
        }

        .sidebar-card {
            background: #fff;
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
            border: 1px solid var(--border);
        }

        .sidebar-card h3 {
            color: var(--text-primary);
            margin-bottom: 18px;
            font-size: 1.1rem;
            font-weight: 700;
        }

        /* Sidebar Tabs */
        .sidebar-tabs {
            display: flex;
            gap: 12px;
            margin-bottom: 20px;
            border-bottom: 2px solid var(--border);
            background: #fff;
            border-radius: 16px;
            padding: 16px 20px 0;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
            border: 1px solid var(--border);
        }

        .sidebar-tab {
            padding: 10px 16px;
            border: none;
            background: none;
            color: var(--text-secondary);
            font-weight: 700;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            margin-bottom: -16px;
            padding-bottom: 16px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 0.9rem;
        }

        .sidebar-tab:hover {
            color: var(--text-primary);
        }

        .sidebar-tab.active {
            color: var(--primary-light);
            border-bottom-color: var(--primary-light);
        }

        .sidebar-content {
            display: none;
        }

        .sidebar-content.active {
            display: block;
        }

        /* Journal Entry - Day One Aesthetic */
        .journal-entry {
            background: #fff;
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 16px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
            border: 1px solid var(--border);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
        }

        .journal-entry:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
            border-color: var(--primary-light);
        }

        .journal-entry-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 12px;
            gap: 12px;
        }

        .journal-entry-date {
            font-weight: 700;
            color: var(--text-primary);
            font-size: 0.95rem;
            letter-spacing: 0.3px;
        }

        .journal-entry-mood {
            font-size: 1.5rem;
            min-width: 24px;
        }

        .journal-entry-text {
            color: var(--text-primary);
            font-size: 0.95rem;
            line-height: 1.6;
            margin-bottom: 12px;
            word-wrap: break-word;
        }

        .journal-entry-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
            font-size: 0.8rem;
            color: var(--text-muted);
            border-bottom: 1px solid var(--border);
            padding-bottom: 12px;
        }

        .journal-entry-stats {
            display: flex;
            gap: 16px;
        }

        .journal-entry-stat {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .journal-entry-tags {
            display: flex;
            gap: 6px;
            flex-wrap: wrap;
            margin-bottom: 12px;
        }

        .journal-entry-tag {
            background: var(--bg-lighter);
            color: var(--primary-light);
            padding: 4px 10px;
            border-radius: 16px;
            font-size: 0.75rem;
            font-weight: 700;
        }

        .journal-entry-actions {
            display: flex;
            gap: 8px;
            justify-content: flex-end;
        }

        .journal-entry-btn {
            background: var(--bg-lighter);
            border: 1px solid var(--border);
            color: var(--primary-light);
            cursor: pointer;
            font-size: 0.8rem;
            padding: 6px 12px;
            border-radius: 8px;
            transition: all 0.2s ease;
            font-weight: 600;
        }

        .journal-entry-btn:hover {
            background: var(--primary-light);
            border-color: var(--primary-light);
            color: #fff;
        }

        .journal-day-header {
            font-weight: 700;
            color: var(--text-primary);
            font-size: 1rem;
            margin: 24px 0 16px 0;
            padding-bottom: 12px;
            border-bottom: 2px solid var(--border);
            letter-spacing: 0.3px;
        }

        .journal-day-events {
            background: linear-gradient(135deg, var(--bg-light) 0%, var(--bg-lighter) 100%);
            border-radius: 10px;
            padding: 14px;
            margin-bottom: 16px;
            font-size: 0.9rem;
            border: 1px solid var(--border);
        }

        .journal-day-event {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(226, 232, 240, 0.6);
        }

        .journal-day-event:last-child {
            margin-bottom: 0;
            padding-bottom: 0;
            border-bottom: none;
        }

        .journal-day-event-badge {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            flex-shrink: 0;
        }

        .journal-day-event-text {
            color: var(--text-primary);
            flex: 1;
            font-weight: 600;
        }

        .journal-no-entries {
            text-align: center;
            padding: 28px 16px;
            color: var(--text-muted);
            font-style: italic;
        }

        /* Mood Selector */
        .mood-selector {
            display: flex;
            gap: 10px;
            margin-bottom: 12px;
            flex-wrap: wrap;
        }

        .mood-btn {
            font-size: 1.8rem;
            background: var(--bg-lighter);
            border: 2px solid var(--border);
            border-radius: 50%;
            width: 52px;
            height: 52px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .mood-btn:hover {
            transform: scale(1.08);
            border-color: var(--primary-light);
        }

        .mood-btn.selected {
            border-color: var(--primary-light);
            background: linear-gradient(135deg, var(--primary-light), var(--accent-light));
            color: #fff;
            box-shadow: 0 4px 12px rgba(64, 86, 161, 0.3);
        }

        /* Tags Input */
        .tags-input-container {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            margin-bottom: 12px;
            padding: 10px;
            background: var(--bg-lighter);
            border: 1px solid var(--border);
            border-radius: 10px;
            min-height: 44px;
            align-items: center;
        }

        .tag-badge {
            background: linear-gradient(135deg, var(--primary-light), var(--accent-light));
            color: #fff;
            padding: 5px 12px;
            border-radius: 16px;
            font-size: 0.8rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .tag-badge-remove {
            cursor: pointer;
            font-weight: bold;
            opacity: 0.85;
            transition: opacity 0.2s ease;
        }

        .tag-badge-remove:hover {
            opacity: 1;
        }

        .tags-input {
            flex: 1;
            min-width: 100px;
            border: none;
            background: transparent;
            outline: none;
            font-size: 0.9rem;
            color: var(--text-primary);
        }

        .tags-input::placeholder {
            color: var(--text-muted);
        }

        /* Event Form */
        .event-form {
            display: flex;
            flex-direction: column;
            gap: 14px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .form-group label {
            font-weight: 700;
            color: var(--text-primary);
            font-size: 0.9rem;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            padding: 11px 12px;
            border: 1px solid var(--border);
            border-radius: 10px;
            font-family: inherit;
            color: var(--text-primary);
            transition: all 0.2s ease;
            background: #fff;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--primary-light);
            box-shadow: 0 0 0 3px rgba(64, 86, 161, 0.1);
        }

        .form-group input::placeholder {
            color: var(--text-muted);
        }

        .add-event-btn {
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            color: #fff;
            border: none;
            padding: 12px;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 700;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            margin-top: 6px;
            box-shadow: 0 4px 12px rgba(43, 58, 103, 0.2);
        }

        .add-event-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(43, 58, 103, 0.3);
        }

        .add-event-btn:active {
            transform: translateY(0);
        }

        /* Upcoming Events */
        .upcoming-events {
            max-height: 400px;
            overflow-y: auto;
        }

        .event-item {
            background: var(--bg-lighter);
            padding: 14px;
            border-radius: 10px;
            margin-bottom: 12px;
            border-left: 4px solid var(--primary-light);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .event-item:hover {
            background: var(--border);
            transform: translateX(4px);
        }

        .event-item-title {
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .event-item-date {
            font-size: 0.8rem;
            color: var(--text-muted);
        }

        .event-item-actions {
            display: flex;
            gap: 8px;
            margin-top: 10px;
        }

        .event-item-btn {
            background: none;
            border: 1px solid var(--border);
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 0.8rem;
            padding: 4px 10px;
            border-radius: 6px;
            transition: all 0.2s ease;
            font-weight: 600;
        }

        .event-item-btn:hover {
            background: var(--primary-light);
            color: #fff;
            border-color: var(--primary-light);
        }

        .empty-message {
            text-align: center;
            color: var(--text-muted);
            padding: 24px 0;
            font-style: italic;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            animation: fadeIn 0.3s ease-out;
            overflow-y: auto;
            backdrop-filter: blur(2px);
        }

        .modal.active {
            display: flex;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        .modal-content {
            background: #fff;
            border-radius: 16px;
            padding: 32px;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.25);
            animation: slideUp 0.3s ease-out;
            margin: auto;
        }

        @keyframes slideUp {
            from {
                transform: translateY(30px);
                opacity: 0;
            }

            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            border-bottom: 1px solid var(--border);
            padding-bottom: 16px;
        }

        .modal-header h2 {
            color: var(--text-primary);
            font-size: 1.5rem;
            font-weight: 700;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--text-muted);
            transition: color 0.2s ease;
        }

        .close-btn:hover {
            color: var(--primary);
        }

        .modal-body {
            margin-bottom: 20px;
            max-height: 60vh;
            overflow-y: auto;
            color: var(--text-secondary);
            line-height: 1.6;
        }

        .modal-footer {
            display: flex;
            gap: 12px;
            justify-content: flex-end;
        }

        .modal-btn {
            padding: 10px 22px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 700;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .modal-btn-primary {
            background: linear-gradient(135deg, var(--primary-light), var(--accent-light));
            color: #fff;
            box-shadow: 0 4px 12px rgba(64, 86, 161, 0.2);
        }

        .modal-btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(64, 86, 161, 0.3);
        }

        .modal-btn-danger {
            background: var(--danger);
            color: #fff;
            box-shadow: 0 4px 12px rgba(239, 68, 68, 0.2);
        }

        .modal-btn-danger:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(239, 68, 68, 0.3);
        }

        .modal-btn-secondary {
            background: var(--bg-lighter);
            color: var(--primary-light);
            border: 1px solid var(--border);
        }

        .modal-btn-secondary:hover {
            background: var(--border);
            border-color: var(--primary-light);
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .layout {
                grid-template-columns: 1fr;
                gap: 28px;
            }

            .sidebar {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 24px;
            }

            .calendar-header h2 {
                font-size: 1.5rem;
            }
        }

        @media (max-width: 768px) {
            body {
                padding: 12px;
            }

            .header {
                margin-bottom: 24px;
                padding: 16px 0;
            }

            .header h1 {
                font-size: 2.2rem;
            }

            .view-toggle {
                margin-bottom: 24px;
            }

            .calendar-wrapper,
            .timeline-wrapper {
                padding: 20px;
            }

            .calendar-header {
                flex-direction: column;
                gap: 16px;
                margin-bottom: 24px;
            }

            .calendar-header h2 {
                font-size: 1.4rem;
            }

            .calendar-nav {
                width: 100%;
                gap: 8px;
            }

            .nav-btn {
                flex: 1;
            }

            .sidebar {
                grid-template-columns: 1fr;
            }

            .day {
                min-height: 100px;
                padding: 8px;
            }

            .day-number {
                font-size: 0.9rem;
            }

            .event-badge {
                font-size: 0.65rem;
                padding: 2px 5px;
            }

            .weekday {
                font-size: 0.75rem;
                padding: 10px 4px;
            }

            .timeline::before {
                left: 20px;
            }

            .timeline-dot {
                left: 7px;
                width: 26px;
                height: 26px;
                font-size: 0.65rem;
            }

            .timeline-event {
                padding-left: 60px;
                margin-bottom: 24px;
            }

            .timeline-day-header {
                padding-left: 60px;
                font-size: 0.85rem;
                margin-bottom: 18px;
            }

            .timeline-event-card {
                padding: 16px;
            }

            .timeline-event-title {
                font-size: 1rem;
            }
        }

        @media (max-width: 480px) {
            body {
                padding: 8px;
            }

            .header h1 {
                font-size: 1.8rem;
            }

            .header p {
                font-size: 0.9rem;
            }

            .toggle-btn {
                padding: 8px 16px;
                font-size: 0.85rem;
            }

            .calendar-wrapper,
            .timeline-wrapper {
                padding: 16px;
            }

            .sidebar {
                gap: 20px;
            }

            .sidebar-card {
                padding: 16px;
            }

            .day {
                aspect-ratio: auto;
                min-height: 80px;
            }

            .calendar-grid {
                gap: 8px;
            }

            .timeline-event {
                padding-left: 50px;
            }

            .timeline::before {
                left: 15px;
            }

            .timeline-dot {
                left: 2px;
                width: 24px;
                height: 24px;
            }
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Journal Writing Modal - Focus Mode */
        .journal-write-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            z-index: 2000;
            animation: fadeIn 0.3s ease-out;
            backdrop-filter: blur(2px);
        }

        .journal-write-modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .journal-write-container {
            background: #fff;
            border-radius: 20px;
            width: 95vw;
            max-width: 900px;
            height: 90vh;
            display: flex;
            flex-direction: column;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.25);
            animation: slideUp 0.4s ease-out;
        }

        .journal-write-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 24px 32px;
            border-bottom: 1px solid var(--border);
            background: linear-gradient(135deg, var(--bg-light) 0%, #fff 100%);
            border-radius: 20px 20px 0 0;
        }

        .journal-write-title {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .journal-write-date {
            font-size: 0.9rem;
            color: var(--text-muted);
            font-weight: 600;
            letter-spacing: 0.3px;
        }

        .journal-write-mood-selector {
            display: flex;
            gap: 10px;
        }

        .journal-write-mood-btn {
            font-size: 1.5rem;
            background: var(--bg-lighter);
            border: 2px solid var(--border);
            border-radius: 50%;
            width: 44px;
            height: 44px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .journal-write-mood-btn:hover {
            transform: scale(1.1);
            border-color: var(--primary-light);
        }

        .journal-write-mood-btn.selected {
            border-color: var(--primary-light);
            background: linear-gradient(135deg, var(--primary-light), var(--accent-light));
            color: #fff;
            box-shadow: 0 4px 12px rgba(64, 86, 161, 0.3);
        }

        .journal-write-close {
            background: none;
            border: none;
            font-size: 1.8rem;
            cursor: pointer;
            color: var(--text-secondary);
            padding: 0;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }

        .journal-write-close:hover {
            color: var(--primary);
            transform: scale(1.1);
        }

        .journal-write-toolbar {
            display: flex;
            gap: 10px;
            padding: 14px 32px;
            background: var(--bg-light);
            border-bottom: 1px solid var(--border);
            flex-wrap: wrap;
            align-items: center;
        }

        .toolbar-section {
            display: flex;
            gap: 6px;
            align-items: center;
            border-right: 1px solid var(--border);
            padding-right: 10px;
        }

        .toolbar-section:last-child {
            border-right: none;
        }

        .toolbar-btn {
            background: #fff;
            border: 1px solid var(--border);
            color: var(--primary-light);
            padding: 8px 12px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.85rem;
            font-weight: 600;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .toolbar-btn:hover {
            background: var(--primary-light);
            color: #fff;
            border-color: var(--primary-light);
        }

        .toolbar-btn.active {
            background: var(--primary-light);
            color: #fff;
        }

        .toolbar-separator {
            width: 1px;
            height: 20px;
            background: var(--border);
            margin: 0 6px;
        }

        .journal-write-content {
            flex: 1;
            display: flex;
            overflow: hidden;
        }

        .journal-editor-area {
            flex: 1;
            display: flex;
            flex-direction: column;
            padding: 32px;
            overflow-y: auto;
        }

        #journalWriteText {
            flex: 1;
            border: none;
            outline: none;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            font-size: 1rem;
            line-height: 1.8;
            color: var(--text-primary);
            resize: none;
            caret-color: var(--primary-light);
        }

        #journalWriteText::placeholder {
            color: var(--text-muted);
            font-style: italic;
        }

        .journal-editor-preview {
            flex: 1;
            padding: 32px;
            overflow-y: auto;
            background: var(--bg-light);
            border-left: 1px solid var(--border);
        }

        .journal-write-preview {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            font-size: 1rem;
            line-height: 1.8;
            color: var(--text-primary);
        }

        .journal-write-preview h1 {
            font-size: 1.8rem;
            font-weight: 700;
            margin: 1.5em 0 0.5em 0;
        }

        .journal-write-preview h2 {
            font-size: 1.5rem;
            font-weight: 700;
            margin: 1.3em 0 0.4em 0;
        }

        .journal-write-preview h3 {
            font-size: 1.2rem;
            font-weight: 700;
            margin: 1.1em 0 0.3em 0;
        }

        .journal-write-preview ul,
        .journal-write-preview ol {
            margin: 1em 0;
            padding-left: 2em;
        }

        .journal-write-preview li {
            margin: 0.3em 0;
        }

        .journal-write-preview img {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            margin: 1em 0;
        }

        .journal-write-preview blockquote {
            border-left: 4px solid var(--primary-light);
            padding-left: 1em;
            margin: 1em 0;
            color: var(--text-secondary);
            font-style: italic;
        }

        .journal-image-insert {
            display: none;
        }

        .journal-image-preview {
            max-width: 100%;
            max-height: 300px;
            margin: 12px 0;
            border-radius: 8px;
        }

        .journal-write-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 32px;
            background: var(--bg-light);
            border-top: 1px solid var(--border);
            border-radius: 0 0 20px 20px;
        }

        .journal-write-stats {
            display: flex;
            gap: 20px;
            font-size: 0.85rem;
            color: var(--text-muted);
        }

        .journal-write-stat {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .journal-write-actions {
            display: flex;
            gap: 12px;
        }

        .journal-write-save {
            background: linear-gradient(135deg, var(--primary-light), var(--accent-light));
            color: #fff;
            border: none;
            padding: 10px 28px;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 700;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 4px 12px rgba(64, 86, 161, 0.2);
        }

        .journal-write-save:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(64, 86, 161, 0.35);
        }

        .journal-write-cancel {
            background: var(--bg-lighter);
            color: var(--primary-light);
            border: 1px solid var(--border);
            padding: 10px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s ease;
        }

        .journal-write-cancel:hover {
            background: var(--bg-lighter);
            border-color: var(--primary-light);
        }

        .journal-auto-save {
            font-size: 0.8rem;
            color: var(--text-muted);
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .journal-auto-save.saved {
            color: var(--success);
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-light);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--border);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--text-muted);
        }
    </style>
</head>

<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>‚ú® Joureli</h1>
            <p>Journal, plan, and organize your life</p>
        </div>

        <!-- View Toggle -->
        <div class="view-toggle">
            <button class="toggle-btn active" onclick="switchView('calendar')">üìÖ Calendar Mode</button>
            <button class="toggle-btn" onclick="switchView('timeline')">üìà Timeline Mode</button>
        </div>

        <!-- Main Layout -->
        <div class="layout">
            <!-- Calendar View -->
            <div class="calendar-wrapper active">
                <div class="calendar-header">
                    <button class="nav-btn" onclick="previousMonth()">‚Üê Previous</button>
                    <h2 id="monthYear"></h2>
                    <button class="nav-btn today-btn" onclick="goToToday()">Today</button>
                    <button class="nav-btn" onclick="nextMonth()">Next ‚Üí</button>
                </div>

                <div class="weekdays">
                    <div class="weekday">Sun</div>
                    <div class="weekday">Mon</div>
                    <div class="weekday">Tue</div>
                    <div class="weekday">Wed</div>
                    <div class="weekday">Thu</div>
                    <div class="weekday">Fri</div>
                    <div class="weekday">Sat</div>
                </div>

                <div class="calendar-grid" id="calendarGrid"></div>
            </div>

            <!-- Timeline View -->
            <div class="timeline-wrapper">
                <div class="calendar-header">
                    <h2>üìà Event Timeline</h2>
                </div>
                <div class="timeline" id="timelineContainer"></div>
            </div>

            <!-- Sidebar -->
            <div class="sidebar">
                <!-- Sidebar Tabs -->
                <div class="sidebar-tabs">
                    <button class="sidebar-tab active" onclick="switchSidebarTab('events')">üìÖ Events</button>
                    <button class="sidebar-tab" onclick="switchSidebarTab('journal')">üìî Journal</button>
                </div>

                <!-- Events Tab -->
                <div class="sidebar-content active" id="eventsTab">
                    <!-- Add Event Card -->
                    <div class="sidebar-card">
                        <h3>üìù New Event</h3>
                        <form class="event-form" onsubmit="addEvent(event)">
                            <div class="form-group">
                                <label>Event Title</label>
                                <input type="text" id="eventTitle" placeholder="e.g., Team Meeting" required>
                            </div>

                            <div class="form-group">
                                <label>Start Date</label>
                                <input type="date" id="eventDate" required>
                            </div>

                            <div class="form-group">
                                <label>End Date (Optional)</label>
                                <input type="date" id="eventEndDate">
                            </div>

                            <div class="form-group">
                                <label>Time</label>
                                <input type="time" id="eventTime">
                            </div>

                            <div class="form-group">
                                <label>Description</label>
                                <textarea id="eventDesc" placeholder="Add details..."
                                    style="resize: none; height: 60px;"></textarea>
                            </div>

                            <div class="form-group">
                                <label>Category</label>
                                <select id="eventCategory">
                                    <option value="work">Work</option>
                                    <option value="personal">Personal</option>
                                    <option value="health">Health</option>
                                    <option value="social">Social</option>
                                    <option value="other">Other</option>
                                </select>
                            </div>

                            <button type="submit" class="add-event-btn">+ Add Event</button>
                        </form>
                    </div>

                    <!-- Upcoming Events -->
                    <div class="sidebar-card">
                        <h3>üìÜ Upcoming Events</h3>
                        <div class="upcoming-events" id="upcomingEvents">
                            <div class="empty-message">No upcoming events</div>
                        </div>
                    </div>
                </div>

                <!-- Journal Tab -->
                <div class="sidebar-content" id="journalTab">
                    <!-- Journal Entry Card -->
                    <div class="sidebar-card">
                        <h3>üìî New Journal Entry</h3>
                        <div class="form-group" style="margin-bottom: 12px;">
                            <label>Date</label>
                            <input type="date" id="journalDate" required>
                        </div>
                        <div class="form-group" style="margin-bottom: 12px;">
                            <label>Tags (press Enter to add)</label>
                            <div class="tags-input-container" id="tagsContainer">
                                <input type="text" class="tags-input" id="tagsInput"
                                    placeholder="e.g., work, health, travel...">
                            </div>
                            <input type="hidden" id="journalTags">
                        </div>
                        <button type="button" class="add-event-btn" onclick="openJournalWriteModal()">‚úèÔ∏è Start
                            Writing</button>
                    </div>

                    <!-- Day Review Card -->
                    <div class="sidebar-card">
                        <h3>üìÖ What Happened Today</h3>
                        <div id="dayReview">
                            <div class="empty-message">Select a date to review</div>
                        </div>
                    </div>

                    <!-- Past Entries Card -->
                    <div class="sidebar-card">
                        <h3>üìö Past Entries</h3>
                        <div id="pastEntries">
                            <div class="empty-message">No entries yet</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Journal Writing Modal - Focus Mode -->
    <div class="journal-write-modal" id="journalWriteModal">
        <div class="journal-write-container">
            <!-- Header -->
            <div class="journal-write-header">
                <div class="journal-write-title">
                    <div class="journal-write-date" id="writeDate">Today</div>
                    <div style="font-size: 1.3rem; font-weight: 600; color: #2b3a67;">‚úèÔ∏è Your Thoughts</div>
                </div>
                <div class="journal-write-mood-selector" id="writeModalMoodSelector">
                    <button type="button" class="journal-write-mood-btn" data-mood="üòä" title="Great">üòä</button>
                    <button type="button" class="journal-write-mood-btn" data-mood="üòå" title="Good">üòå</button>
                    <button type="button" class="journal-write-mood-btn" data-mood="üòê" title="Okay">üòê</button>
                    <button type="button" class="journal-write-mood-btn" data-mood="üòî" title="Sad">üòî</button>
                    <button type="button" class="journal-write-mood-btn" data-mood="üò§" title="Frustrated">üò§</button>
                </div>
                <button class="journal-write-close" onclick="closeJournalWriteModal()">√ó</button>
            </div>

            <!-- Toolbar -->
            <div class="journal-write-toolbar">
                <div class="toolbar-section">
                    <button type="button" class="toolbar-btn" title="Bold (Ctrl+B)"
                        onclick="insertMarkdown('**', '**')">
                        <span style="font-weight: bold;">B</span>
                    </button>
                    <button type="button" class="toolbar-btn" title="Italic (Ctrl+I)"
                        onclick="insertMarkdown('_', '_')">
                        <span style="font-style: italic;">I</span>
                    </button>
                    <button type="button" class="toolbar-btn" title="Underline" onclick="insertMarkdown('<u>', '</u>')">
                        <span style="text-decoration: underline;">U</span>
                    </button>
                </div>

                <div class="toolbar-section">
                    <button type="button" class="toolbar-btn" title="Heading 1"
                        onclick="insertMarkdown('# ', '')">H1</button>
                    <button type="button" class="toolbar-btn" title="Heading 2"
                        onclick="insertMarkdown('## ', '')">H2</button>
                    <button type="button" class="toolbar-btn" title="Heading 3"
                        onclick="insertMarkdown('### ', '')">H3</button>
                </div>

                <div class="toolbar-section">
                    <button type="button" class="toolbar-btn" title="Bullet List" onclick="insertMarkdown('‚Ä¢ ', '')">‚Ä¢
                        List</button>
                    <button type="button" class="toolbar-btn" title="Numbered List"
                        onclick="insertMarkdown('1. ', '')">1. List</button>
                    <button type="button" class="toolbar-btn" title="Quote"
                        onclick="insertMarkdown('> ', '')">Quote</button>
                </div>

                <div class="toolbar-section">
                    <button type="button" class="toolbar-btn" title="Insert Link" onclick="insertLink()">üîó
                        Link</button>
                    <button type="button" class="toolbar-btn"
                        onclick="document.getElementById('journalImageInsert').click()">
                        üñºÔ∏è Image
                    </button>
                    <input type="file" id="journalImageInsert" class="journal-image-insert" accept="image/*"
                        onchange="insertImage(event)">
                </div>

                <div class="toolbar-section">
                    <button type="button" class="toolbar-btn" id="previewToggle" onclick="togglePreview()">üëÅÔ∏è
                        Preview</button>
                </div>
            </div>

            <!-- Content Area -->
            <div class="journal-write-content">
                <div class="journal-editor-area">
                    <textarea id="journalWriteText"
                        placeholder="Write freely. Express yourself. No judgment, no limits..."></textarea>
                </div>
                <div class="journal-editor-preview" id="previewArea" style="display: none;">
                    <div class="journal-write-preview" id="previewContent"></div>
                </div>
            </div>

            <!-- Footer -->
            <div class="journal-write-footer">
                <div class="journal-write-stats">
                    <div class="journal-write-stat">
                        <span>üìä</span>
                        <span id="writeWordCount">0 words</span>
                    </div>
                    <div class="journal-write-stat">
                        <span>üî§</span>
                        <span id="writeCharCount">0 characters</span>
                    </div>
                    <div class="journal-auto-save" id="autoSaveIndicator">
                        <span>‚è±Ô∏è</span>
                        <span>Saving...</span>
                    </div>
                </div>

                <div class="journal-write-actions">
                    <button class="journal-write-cancel" onclick="closeJournalWriteModal()">Discard</button>
                    <button class="journal-write-save" onclick="saveFromWriteModal()">Save Entry</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Event Details/Edit Modal -->
    <div class="modal" id="eventModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle">Event Details</h2>
                <button class="close-btn" onclick="closeModal()">√ó</button>
            </div>
            <div class="modal-body" id="modalBody"></div>
            <div class="modal-footer">
                <button class="modal-btn modal-btn-danger" onclick="deleteEvent()">Delete</button>
                <button class="modal-btn modal-btn-secondary" onclick="closeModal()">Close</button>
            </div>
        </div>
    </div>

    <script>
        let currentDate = new Date();
        let events = JSON.parse(localStorage.getItem('joureviEvents')) || [];
        let journals = JSON.parse(localStorage.getItem('joureviJournals')) || [];
        let selectedEventId = null;
        let isEditMode = false;
        let currentView = 'calendar';
        let currentSidebarTab = 'events';
        let currentMood = null;
        let currentTags = [];
        let editingJournalId = null;
        let editingEventId = null;
        let journalDraft = JSON.parse(localStorage.getItem('joureviDraft')) || null;

        const COLORS = {
            work: '#4056a1',
            personal: '#8b5cf6',
            health: '#10b981',
            social: '#f59e0b',
            other: '#6b7280'
        };

        function initializeCalendar() {
            const today = new Date();
            document.getElementById('eventDate').valueAsDate = today;
            document.getElementById('journalDate').valueAsDate = today;
            renderCalendar();
            renderTimeline();
            renderUpcomingEvents();
            renderDayReview(today);
            renderPastEntries();
            setupMoodSelector();
            setupTagsInput();
        }

        function setupMoodSelector() {
            document.querySelectorAll('.mood-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.preventDefault();
                    document.querySelectorAll('.mood-btn').forEach(b => b.classList.remove('selected'));
                    btn.classList.add('selected');
                    currentMood = btn.getAttribute('data-mood');
                    document.getElementById('journalMood').value = currentMood;
                });
            });
        }

        function setupTagsInput() {
            const input = document.getElementById('tagsInput');
            input.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    const tag = input.value.trim().toLowerCase();
                    if (tag && !currentTags.includes(tag)) {
                        currentTags.push(tag);
                        renderTags();
                        input.value = '';
                        updateTagsField();
                    }
                }
            });
        }

        function renderTags() {
            const container = document.getElementById('tagsContainer');
            const input = container.querySelector('.tags-input');
            container.innerHTML = '';
            currentTags.forEach(tag => {
                const badge = document.createElement('div');
                badge.className = 'tag-badge';
                badge.innerHTML = `${tag} <span class="tag-badge-remove" onclick="removeTag('${tag}')">√ó</span>`;
                container.appendChild(badge);
            });
            container.appendChild(input);
        }

        function removeTag(tag) {
            currentTags = currentTags.filter(t => t !== tag);
            renderTags();
            updateTagsField();
        }

        function updateTagsField() {
            document.getElementById('journalTags').value = JSON.stringify(currentTags);
        }

        function switchSidebarTab(tab) {
            currentSidebarTab = tab;
            document.querySelectorAll('.sidebar-tab').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.sidebar-content').forEach(el => el.classList.remove('active'));

            if (tab === 'events') {
                document.querySelector('.sidebar-tab:nth-child(1)').classList.add('active');
                document.getElementById('eventsTab').classList.add('active');
            } else {
                document.querySelector('.sidebar-tab:nth-child(2)').classList.add('active');
                document.getElementById('journalTab').classList.add('active');
            }
        }

        function switchView(view) {
            currentView = view;
            document.querySelectorAll('.toggle-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.calendar-wrapper, .timeline-wrapper').forEach(el => el.classList.remove('active'));

            if (view === 'calendar') {
                document.querySelector('.toggle-btn:first-child').classList.add('active');
                document.querySelector('.calendar-wrapper').classList.add('active');
                renderCalendar();
            } else {
                document.querySelector('.toggle-btn:last-child').classList.add('active');
                document.querySelector('.timeline-wrapper').classList.add('active');
                renderTimeline();
            }
        }

        function renderCalendar() {
            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();

            document.getElementById('monthYear').textContent = currentDate.toLocaleDateString('en-US', {
                month: 'long',
                year: 'numeric'
            });

            const firstDay = new Date(year, month, 1);
            const lastDay = new Date(year, month + 1, 0);
            const startDate = new Date(firstDay);
            startDate.setDate(startDate.getDate() - firstDay.getDay());

            const grid = document.getElementById('calendarGrid');
            grid.innerHTML = '';

            let currentDateTemp = new Date(startDate);
            const dayElements = [];

            for (let i = 0; i < 42; i++) {
                const dayEl = document.createElement('div');
                dayEl.className = 'day';

                if (currentDateTemp.getMonth() !== month) {
                    dayEl.classList.add('other-month');
                }

                const today = new Date();
                if (currentDateTemp.getFullYear() === today.getFullYear() &&
                    currentDateTemp.getMonth() === today.getMonth() &&
                    currentDateTemp.getDate() === today.getDate()) {
                    dayEl.classList.add('today');
                }

                const dayDate = new Date(currentDateTemp);
                const dayNumber = currentDateTemp.getDate();
                const dateStr = dateToString(currentDateTemp);

                // Find events on this day (single-day and multi-day)
                const dayEvents = events.filter(e => {
                    const eventStart = new Date(e.date);
                    const eventEnd = new Date(e.endDate || e.date);
                    const currentDay = new Date(dateStr);
                    return currentDay >= eventStart && currentDay <= eventEnd;
                });

                // Separate single-day and multi-day events
                const singleDayEvents = dayEvents.filter(e => e.date === dateStr && (!e.endDate || e.endDate === e.date));
                const multiDayEvents = dayEvents.filter(e => e.endDate && e.endDate !== e.date);

                dayEl.innerHTML = `
					<div class="day-number">${dayNumber}</div>
					<div class="day-events">
						${singleDayEvents.slice(0, 2).map(e => `
							<div class="event-badge" style="background-color: ${COLORS[e.category]}; color: #fff;" onclick="viewEvent('${e.id}', event)">
								${e.title}
							</div>
						`).join('')}
						${singleDayEvents.length > 2 ? `<div class="event-count">+${singleDayEvents.length - 2} more</div>` : ''}
					</div>
				`;

                // Add multi-day event bars
                multiDayEvents.forEach(e => {
                    const eventStart = new Date(e.date);
                    const eventEnd = new Date(e.endDate);
                    const isStart = dateStr === e.date;
                    const isEnd = dateStr === e.endDate;

                    const bar = document.createElement('div');
                    bar.className = 'multi-day-event';
                    if (isStart) bar.className += ' multi-day-event-start';
                    if (isEnd) bar.className += ' multi-day-event-end';
                    if (!isStart && !isEnd) bar.className += ' multi-day-event-middle';

                    bar.style.setProperty('--event-color', COLORS[e.category]);
                    bar.textContent = `${isStart ? '‚ñ∂ ' : ''}${e.title}${isEnd ? ' ‚óÄ' : ''}`;
                    bar.onclick = (evt) => { evt.stopPropagation(); viewEvent(e.id); };
                    dayEl.appendChild(bar);
                });

                dayEl.addEventListener('click', () => selectDate(dayDate));
                dayElements.push({ el: dayEl, dateStr });
                grid.appendChild(dayEl);

                currentDateTemp.setDate(currentDateTemp.getDate() + 1);
            }
        }

        function renderTimeline() {
            const sortedEvents = [...events]
                .sort((a, b) => {
                    const dateA = new Date(a.date + ' ' + a.time);
                    const dateB = new Date(b.date + ' ' + b.time);
                    return dateA - dateB;
                });

            const container = document.getElementById('timelineContainer');

            if (sortedEvents.length === 0) {
                container.innerHTML = '<div class="empty-message">No events scheduled</div>';
                return;
            }

            // Group events by day
            const groupedByDay = {};
            sortedEvents.forEach(e => {
                if (!groupedByDay[e.date]) {
                    groupedByDay[e.date] = [];
                }
                groupedByDay[e.date].push(e);
            });

            // Create timeline with day groups
            let html = '';
            Object.keys(groupedByDay).forEach(date => {
                const dayEvents = groupedByDay[date];
                const dateObj = new Date(date);
                const dateStr = dateObj.toLocaleDateString('en-US', {
                    weekday: 'long',
                    month: 'short',
                    day: 'numeric',
                    year: 'numeric'
                });

                html += `<div class="timeline-day-group"><div class="timeline-day-header">üìÖ ${dateStr}</div>`;

                dayEvents.forEach((e, idx) => {
                    html += `
						<div class="timeline-event">
							<div class="timeline-dot" style="border-color: ${COLORS[e.category]}; background: ${COLORS[e.category]};"></div>
							<div class="timeline-event-card" style="--border-color: ${COLORS[e.category]};">
								<div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 10px;">
									<div>
										${e.time !== '00:00' ? `<div class="timeline-event-time">‚è∞ ${e.time}</div>` : '<div class="timeline-event-time">üìå All Day</div>'}
										<div class="timeline-event-title">${e.title}</div>
									</div>
									<div class="timeline-event-category" style="background: ${COLORS[e.category]}; color: #fff;">${e.category}</div>
								</div>
								${e.description ? `<div class="timeline-event-desc">${e.description}</div>` : ''}
								<div class="timeline-event-actions">
									<button class="timeline-event-btn" onclick="viewEvent('${e.id}', event)">View</button>
									<button class="timeline-event-btn" onclick="editEvent('${e.id}', event)">Edit</button>
									<button class="timeline-event-btn" onclick="deleteEventById('${e.id}')">Delete</button>
								</div>
							</div>
						</div>
					`;
                });

                html += `</div>`;
            });

            container.innerHTML = html;

            // Apply border color to cards
            document.querySelectorAll('.timeline-event-card').forEach(card => {
                const borderColor = card.style.getPropertyValue('--border-color');
                if (borderColor) {
                    card.style.borderLeftColor = borderColor;
                }
                const bar = card.querySelector('.timeline-event-card::before');
                if (borderColor) {
                    card.style.setProperty('--border-left', borderColor);
                }
            });
        }

        function selectDate(date) {
            document.getElementById('eventDate').valueAsDate = date;
            document.getElementById('journalDate').valueAsDate = date;
            document.getElementById('eventTitle').focus();
            renderDayReview(date);
        }

        function previousMonth() {
            currentDate.setMonth(currentDate.getMonth() - 1);
            renderCalendar();
        }

        function nextMonth() {
            currentDate.setMonth(currentDate.getMonth() + 1);
            renderCalendar();
        }

        function goToToday() {
            currentDate = new Date();
            renderCalendar();
        }

        function dateToString(date) {
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            return `${year}-${month}-${day}`;
        }

        function addEvent(e) {
            e.preventDefault();

            const title = document.getElementById('eventTitle').value;
            const date = document.getElementById('eventDate').value;
            const endDate = document.getElementById('eventEndDate').value;
            const time = document.getElementById('eventTime').value;
            const desc = document.getElementById('eventDesc').value;
            const category = document.getElementById('eventCategory').value;

            if (!title || !date) return;

            // Validate date range
            if (endDate && new Date(endDate) < new Date(date)) {
                alert('End date must be after or equal to start date');
                return;
            }

            if (editingEventId) {
                // Update existing event
                const eventIndex = events.findIndex(ev => ev.id === editingEventId);
                if (eventIndex !== -1) {
                    events[eventIndex].title = title;
                    events[eventIndex].date = date;
                    events[eventIndex].endDate = endDate || date;
                    events[eventIndex].time = time || '00:00';
                    events[eventIndex].description = desc;
                    events[eventIndex].category = category;
                    events[eventIndex].updatedAt = new Date().toISOString();
                }
                editingEventId = null;
            } else {
                // Add new event
                const event = {
                    id: Date.now().toString(),
                    title,
                    date,
                    endDate: endDate || date,
                    time: time || '00:00',
                    description: desc,
                    category,
                    createdAt: new Date().toISOString()
                };
                events.push(event);
            }

            saveEvents();
            renderCalendar();
            renderTimeline();
            renderUpcomingEvents();

            // Reset form
            document.getElementById('eventTitle').value = '';
            document.getElementById('eventTime').value = '';
            document.getElementById('eventDesc').value = '';
            document.getElementById('eventEndDate').value = '';

            const today = new Date();
            document.getElementById('eventDate').valueAsDate = today;
        }

        function renderUpcomingEvents() {
            const upcoming = events
                .filter(e => new Date(e.date) >= new Date(new Date().toISOString().split('T')[0]))
                .sort((a, b) => new Date(a.date) - new Date(b.date))
                .slice(0, 10);

            const container = document.getElementById('upcomingEvents');

            if (upcoming.length === 0) {
                container.innerHTML = '<div class="empty-message">No upcoming events</div>';
                return;
            }

            container.innerHTML = upcoming.map(e => `
				<div class="event-item" style="border-left-color: ${COLORS[e.category]}">
					<div class="event-item-title">${e.title}</div>
					<div class="event-item-date">
						${new Date(e.date).toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}
						${e.time !== '00:00' ? ` at ${e.time}` : ''}
					</div>
					<div class="event-item-actions">
						<button class="event-item-btn" onclick="viewEvent('${e.id}')">Details</button>
						<button class="event-item-btn" onclick="editEvent('${e.id}')">Edit</button>
					</div>
				</div>
			`).join('');
        }

        function viewEvent(eventId, e) {
            if (e) e.stopPropagation();
            selectedEventId = eventId;
            isEditMode = false;
            const event = events.find(ev => ev.id === eventId);

            if (!event) return;

            const startDate = new Date(event.date);
            const endDate = new Date(event.endDate || event.date);
            const isMultiDay = event.endDate && event.endDate !== event.date;
            const daysSpan = isMultiDay ? Math.ceil((endDate - startDate) / (1000 * 60 * 60 * 24)) + 1 : 1;

            const dateStr = startDate.toLocaleDateString('en-US', {
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });

            const endDateStr = isMultiDay ? endDate.toLocaleDateString('en-US', {
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            }) : '';

            const modal = document.getElementById('eventModal');
            document.getElementById('modalTitle').textContent = event.title;
            document.getElementById('modalBody').innerHTML = `
				<div style="color: #4f5d75;">
					<p><strong>${isMultiDay ? 'Date Range:' : 'Date:'}</strong> ${dateStr}${isMultiDay ? ` ‚Üí ${endDateStr}` : ''}</p>
					${isMultiDay ? `<p><strong>Duration:</strong> ${daysSpan} day${daysSpan > 1 ? 's' : ''}</p>` : ''}
					<p><strong>Time:</strong> ${event.time !== '00:00' ? event.time : 'All day'}</p>
					<p><strong>Category:</strong> <span style="display: inline-block; background: ${COLORS[event.category]}; color: #fff; padding: 2px 8px; border-radius: 4px; text-transform: capitalize;">${event.category}</span></p>
					${event.description ? `<p><strong>Description:</strong> ${event.description}</p>` : ''}
				</div>
			`;

            modal.classList.add('active');
        }

        function editEvent(eventId, e) {
            if (e) e.stopPropagation();
            editingEventId = eventId;
            const event = events.find(ev => ev.id === eventId);

            if (!event) return;

            document.getElementById('eventTitle').value = event.title;
            document.getElementById('eventDate').value = event.date;
            document.getElementById('eventEndDate').value = event.endDate || event.date;
            document.getElementById('eventTime').value = event.time;
            document.getElementById('eventDesc').value = event.description || '';
            document.getElementById('eventCategory').value = event.category;
            document.getElementById('eventTitle').focus();

            closeModal();
        }

        // Journal Write Modal Functions
        function openJournalWriteModal(entryId = null) {
            const date = new Date(document.getElementById('journalDate').value);
            const dateStr = date.toLocaleDateString('en-US', {
                weekday: 'long',
                month: 'long',
                day: 'numeric'
            });

            document.getElementById('writeDate').textContent = dateStr;
            document.getElementById('journalWriteText').value = '';
            document.getElementById('previewContent').innerHTML = '';
            document.getElementById('previewArea').style.display = 'none';
            document.getElementById('previewToggle').classList.remove('active');

            editingJournalId = entryId || null;

            // Load draft or entry data
            if (entryId) {
                // Loading existing entry for editing
                const entry = journals.find(j => j.id === entryId);
                if (entry) {
                    document.getElementById('journalWriteText').value = entry.text;
                    currentMood = entry.mood || null;
                    currentTags = entry.tags && entry.tags.length > 0 ? [...entry.tags] : [];
                }
            } else if (journalDraft) {
                // Loading draft
                document.getElementById('journalWriteText').value = journalDraft.text || '';
                currentMood = journalDraft.mood || null;
                currentTags = journalDraft.tags || [];
                // Auto-restore date if it's today
                if (journalDraft.date === document.getElementById('journalDate').value) {
                    renderTags();
                    updateTagsField();
                }
            }

            renderTags();
            updateTagsField();

            // Setup mood selector in write modal
            document.querySelectorAll('.journal-write-mood-btn').forEach(btn => {
                btn.classList.remove('selected');
                btn.addEventListener('click', (e) => {
                    e.preventDefault();
                    document.querySelectorAll('.journal-write-mood-btn').forEach(b => b.classList.remove('selected'));
                    btn.classList.add('selected');
                    currentMood = btn.getAttribute('data-mood');
                    saveDraft();
                });
            });

            // Set selected mood if any
            if (currentMood) {
                const selectedBtn = document.querySelector(`.journal-write-mood-btn[data-mood="${currentMood}"]`);
                if (selectedBtn) selectedBtn.classList.add('selected');
            }

            document.getElementById('journalWriteText').focus();
            setupWriteModalStats();

            document.getElementById('journalWriteModal').classList.add('active');
        }

        function closeJournalWriteModal() {
            saveDraft();
            document.getElementById('journalWriteModal').classList.remove('active');
            editingJournalId = null;
            currentMood = null;
        }

        function saveDraft() {
            const date = document.getElementById('journalDate').value;
            const text = document.getElementById('journalWriteText').value;

            if (text.trim()) {
                journalDraft = {
                    date,
                    text,
                    mood: currentMood,
                    tags: [...currentTags],
                    savedAt: new Date().toISOString()
                };
                localStorage.setItem('joureviDraft', JSON.stringify(journalDraft));
            } else {
                journalDraft = null;
                localStorage.removeItem('joureviDraft');
            }
        }

        function clearDraft() {
            journalDraft = null;
            localStorage.removeItem('joureviDraft');
        }

        function setupWriteModalStats() {
            const textarea = document.getElementById('journalWriteText');
            let draftTimeout;

            textarea.addEventListener('input', () => {
                const text = textarea.value;
                const words = text.trim() ? text.trim().split(/\s+/).length : 0;
                const chars = text.length;

                document.getElementById('writeWordCount').textContent = words + ' word' + (words !== 1 ? 's' : '');
                document.getElementById('writeCharCount').textContent = chars + ' character' + (chars !== 1 ? 's' : '');

                // Update preview if visible
                if (document.getElementById('previewArea').style.display !== 'none') {
                    updatePreview();
                }

                // Auto-save draft after user stops typing
                clearTimeout(draftTimeout);
                draftTimeout = setTimeout(() => {
                    saveDraft();
                    showDraftSaved();
                }, 1500);
            });
        }

        function showDraftSaved() {
            const indicator = document.getElementById('autoSaveIndicator');
            indicator.classList.add('saved');
            indicator.innerHTML = '<span>‚úì</span><span>Draft saved</span>';
            setTimeout(() => {
                if (indicator.classList.contains('saved')) {
                    indicator.classList.remove('saved');
                    indicator.innerHTML = '<span>‚è±Ô∏è</span><span>Saving...</span>';
                }
            }, 2000);
        }

        function insertMarkdown(before, after) {
            const textarea = document.getElementById('journalWriteText');
            const start = textarea.selectionStart;
            const end = textarea.selectionEnd;
            const selectedText = textarea.value.substring(start, end);
            const beforeText = textarea.value.substring(0, start);
            const afterText = textarea.value.substring(end);

            const newText = beforeText + before + selectedText + after + afterText;
            textarea.value = newText;
            textarea.focus();
            textarea.selectionStart = start + before.length;
            textarea.selectionEnd = start + before.length + selectedText.length;

            // Trigger input event for stats update
            textarea.dispatchEvent(new Event('input'));
        }

        function insertLink() {
            const url = prompt('Enter URL:');
            if (!url) return;
            insertMarkdown('[', '](' + url + ')');
        }

        function insertImage(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = (e) => {
                const imgData = e.target.result;
                const textarea = document.getElementById('journalWriteText');
                const start = textarea.selectionStart;
                const before = textarea.value.substring(0, start);
                const after = textarea.value.substring(start);

                textarea.value = before + '\n[Image inserted]\n' + after;
                textarea.focus();

                // Store image data
                if (!window.journalImages) window.journalImages = [];
                window.journalImages.push({ data: imgData, alt: file.name });

                // Show in preview if visible
                if (document.getElementById('previewArea').style.display !== 'none') {
                    updatePreview();
                }

                textarea.dispatchEvent(new Event('input'));
            };
            reader.readAsDataURL(file);
        }

        function togglePreview() {
            const previewArea = document.getElementById('previewArea');
            const toggle = document.getElementById('previewToggle');

            if (previewArea.style.display === 'none') {
                previewArea.style.display = 'block';
                toggle.classList.add('active');
                updatePreview();
            } else {
                previewArea.style.display = 'none';
                toggle.classList.remove('active');
            }
        }

        function updatePreview() {
            const text = document.getElementById('journalWriteText').value;
            let html = markdownToHtml(text);
            document.getElementById('previewContent').innerHTML = html;
        }

        function markdownToHtml(text) {
            let html = text;

            // Headers
            html = html.replace(/^### (.*?)$/gm, '<h3>$1</h3>');
            html = html.replace(/^## (.*?)$/gm, '<h2>$1</h2>');
            html = html.replace(/^# (.*?)$/gm, '<h1>$1</h1>');

            // Bold
            html = html.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');

            // Italic
            html = html.replace(/_(.*?)_/g, '<em>$1</em>');

            // Blockquote
            html = html.replace(/^> (.*?)$/gm, '<blockquote>$1</blockquote>');

            // Lists
            html = html.replace(/^\‚Ä¢ (.*?)$/gm, '<li>$1</li>');
            html = html.replace(/^\d+\. (.*?)$/gm, '<li>$1</li>');

            // Line breaks
            html = html.replace(/\n/g, '<br>');

            // Links
            html = html.replace(/\[(.*?)\]\((.*?)\)/g, '<a href="$2" target="_blank">$1</a>');

            // Images from inserted images
            if (window.journalImages && window.journalImages.length > 0) {
                window.journalImages.forEach(img => {
                    html = html.replace('[Image inserted]', `<img src="${img.data}" alt="${img.alt}" class="journal-image-preview">`);
                });
            }

            return html;
        }

        function saveFromWriteModal() {
            const date = document.getElementById('journalDate').value;
            const text = document.getElementById('journalWriteText').value;
            const mood = currentMood || 'üìù';
            const tags = [...currentTags];

            if (!date || !text.trim()) {
                alert('Please write something before saving.');
                return;
            }

            if (editingJournalId) {
                // Update existing entry
                const entryIndex = journals.findIndex(j => j.id === editingJournalId);
                if (entryIndex !== -1) {
                    journals[entryIndex].date = date;
                    journals[entryIndex].text = text;
                    journals[entryIndex].mood = mood;
                    journals[entryIndex].tags = tags;
                    journals[entryIndex].updatedAt = new Date().toISOString();
                }
            } else {
                // Create new entry
                const entry = {
                    id: Date.now().toString(),
                    date,
                    text,
                    mood,
                    tags,
                    createdAt: new Date().toISOString()
                };
                journals.push(entry);
            }

            saveJournals();
            clearDraft();

            // Reset
            closeJournalWriteModal();
            currentMood = null;
            currentTags = [];
            window.journalImages = [];
            editingJournalId = null;
            document.getElementById('tagsContainer').innerHTML = '<input type="text" class="tags-input" id="tagsInput" placeholder="e.g., work, health, travel...">';
            setupTagsInput();

            // Refresh views
            renderDayReview(new Date(date));
            renderPastEntries();
        }

        function renderDayReview(date) {
            const dateStr = dateToString(date);
            const dayEvents = events.filter(e => {
                const eventStart = new Date(e.date);
                const eventEnd = new Date(e.endDate || e.date);
                const currentDay = new Date(dateStr);
                return currentDay >= eventStart && currentDay <= eventEnd;
            });

            const container = document.getElementById('dayReview');
            const dateDisplay = date.toLocaleDateString('en-US', {
                weekday: 'long',
                month: 'short',
                day: 'numeric'
            });

            if (dayEvents.length === 0) {
                container.innerHTML = `<div class="journal-day-header">${dateDisplay}</div><div class="empty-message">No events scheduled</div>`;
                return;
            }

            let html = `<div class="journal-day-header">${dateDisplay}</div><div class="journal-day-events">`;
            dayEvents.forEach(e => {
                html += `
					<div class="journal-day-event">
						<div class="journal-day-event-badge" style="background-color: ${COLORS[e.category]};"></div>
						<div class="journal-day-event-text">
							<strong>${e.title}</strong>
							${e.time !== '00:00' ? ` at ${e.time}` : ' (All day)'}
						</div>
					</div>
				`;
            });
            html += `</div>`;
            container.innerHTML = html;
        }

        function renderPastEntries() {
            const sortedJournals = [...journals].sort((a, b) => new Date(b.date) - new Date(a.date)).slice(0, 8);
            const container = document.getElementById('pastEntries');

            if (sortedJournals.length === 0) {
                container.innerHTML = '<div class="journal-no-entries">No entries yet. Start your first entry above.</div>';
                return;
            }

            let html = '';
            let currentDateGroup = null;

            sortedJournals.forEach(entry => {
                const entryDate = new Date(entry.date);
                const dateParts = entryDate.toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' }).split(' ');
                const dayOfWeek = entryDate.toLocaleDateString('en-US', { weekday: 'short' });
                const dateStr = `${dayOfWeek}, ${dateParts[0]} ${dateParts[1]}`;

                // Add date header if changed
                if (currentDateGroup !== entry.date) {
                    if (currentDateGroup !== null) html += '</div>';
                    html += `<div class="journal-day-header">${dateStr}</div>`;
                    currentDateGroup = entry.date;
                }

                const wordCount = entry.text.trim().split(/\s+/).length;
                const readTime = Math.ceil(wordCount / 200); // avg 200 words per minute
                const preview = entry.text.substring(0, 90) + (entry.text.length > 90 ? '...' : '');

                html += `
					<div class="journal-entry">
						<div class="journal-entry-header">
							<div class="journal-entry-date">${dateStr}</div>
							<div class="journal-entry-mood">${entry.mood || 'üìù'}</div>
						</div>
						${entry.tags && entry.tags.length > 0 ? `
							<div class="journal-entry-tags">
								${entry.tags.map(tag => `<span class="journal-entry-tag">#${tag}</span>`).join('')}
							</div>
						` : ''}
						<div class="journal-entry-text">${preview}</div>
						<div class="journal-entry-meta">
							<div class="journal-entry-stats">
								<div class="journal-entry-stat">
									<span>üìä</span>
									<span>${wordCount} words</span>
								</div>
								<div class="journal-entry-stat">
									<span>‚è±Ô∏è</span>
									<span>${readTime} min read</span>
								</div>
							</div>
						</div>
						<div class="journal-entry-actions">
							<button class="journal-entry-btn" onclick="viewJournalEntry('${entry.id}')">Read</button>
							<button class="journal-entry-btn" onclick="editJournalEntry('${entry.id}')">Edit</button>
							<button class="journal-entry-btn" onclick="deleteJournalEntry('${entry.id}')">Delete</button>
						</div>
					</div>
				`;
            });
            if (currentDateGroup !== null) html += '</div>';

            container.innerHTML = html;
        }

        function viewJournalEntry(entryId) {
            const entry = journals.find(j => j.id === entryId);
            if (!entry) return;

            const entryDate = new Date(entry.date);
            const dateStr = entryDate.toLocaleDateString('en-US', {
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });

            const wordCount = entry.text.trim().split(/\s+/).length;
            const readTime = Math.ceil(wordCount / 200);
            const charCount = entry.text.length;

            const modal = document.getElementById('eventModal');
            document.getElementById('modalTitle').textContent = entry.mood + ' Journal Entry';
            document.getElementById('modalBody').innerHTML = `
				<div style="color: #4f5d75;">
					<p style="font-size: 1.1rem; font-weight: 600; color: #2b3a67; margin-bottom: 12px;">${dateStr}</p>
					${entry.tags && entry.tags.length > 0 ? `
						<div style="margin-bottom: 16px; display: flex; gap: 6px; flex-wrap: wrap;">
							${entry.tags.map(tag => `<span style="background: #f0f3f7; color: #4056a1; padding: 4px 10px; border-radius: 16px; font-size: 0.85rem; font-weight: 500;">#${tag}</span>`).join('')}
						</div>
					` : ''}
					<div style="display: flex; gap: 20px; margin-bottom: 20px; padding: 12px; background: #f8fafc; border-radius: 8px; font-size: 0.9rem;">
						<div><strong>üìä Words:</strong> ${wordCount}</div>
						<div><strong>‚è±Ô∏è Read time:</strong> ${readTime} min</div>
						<div><strong>üî§ Characters:</strong> ${charCount}</div>
					</div>
					<p style="margin-top: 15px; white-space: pre-wrap; line-height: 1.8; font-size: 0.95rem; color: #3a3a3a;">${entry.text}</p>
				</div>
			`;

            const footer = document.querySelector('.modal-footer');
            footer.innerHTML = `
				<button class="modal-btn modal-btn-danger" onclick="deleteJournalEntry('${entry.id}')">Delete</button>
				<button class="modal-btn modal-btn-secondary" onclick="closeModal()">Close</button>
			`;

            modal.classList.add('active');
        }

        function editJournalEntry(entryId) {
            const entry = journals.find(j => j.id === entryId);
            if (!entry) return;

            document.getElementById('journalDate').value = entry.date;

            // Close any open modals first
            closeModal();
            switchSidebarTab('journal');

            // Open write modal with the entry ID for editing
            setTimeout(() => {
                openJournalWriteModal(entryId);
                document.getElementById('journalWriteText').focus();
            }, 100);
        }

        function deleteJournalEntry(entryId) {
            if (confirm('Are you sure you want to delete this entry?')) {
                journals = journals.filter(j => j.id !== entryId);
                saveJournals();
                renderPastEntries();
                closeModal();
            }
        }

        function saveJournals() {
            localStorage.setItem('joureviJournals', JSON.stringify(journals));
        }

        function closeModal() {
            document.getElementById('eventModal').classList.remove('active');
            selectedEventId = null;
        }

        function deleteEvent() {
            if (selectedEventId) {
                deleteEventById(selectedEventId);
            }
        }

        function deleteEventById(eventId) {
            events = events.filter(e => e.id !== eventId);
            saveEvents();
            renderCalendar();
            renderTimeline();
            renderUpcomingEvents();
            closeModal();
        }

        function saveEvents() {
            localStorage.setItem('joureviEvents', JSON.stringify(events));
        }

        // Close modal when clicking outside
        document.getElementById('eventModal').addEventListener('click', (e) => {
            if (e.target.id === 'eventModal') {
                closeModal();
            }
        });

        // Initialize
        initializeCalendar();
    </script>
</body>

</html>
